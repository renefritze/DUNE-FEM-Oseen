In diesem Kapitel geht es um spannende Sachen.

\section{Stationäre Stokes Gleichung}\label{section::ldg_stokes::stationaere_stokes_gleichung}

\begin{definition}[Stationäres Stokes System]\label{definition::ldg_stokes::stationäres_stokes_system}
Sei $\Omega \subset \R^d$ ein beschränktes Gebiet ($d=2,3$), gegeben seien
Randwerte $g_D :\Omega \mapsto \R^d$ und eine Rechte Seite
$f: \Omega \mapsto \R^d$.
Gesucht wird die Geschwindigkeit $u:\Omega \mapsto \R^d$
und der Druck $p:\Omega \mapsto \R$ eines Fluids mit Viskosität
$\mu \in R^{>0}$ als Lösung des stationären Stokes Systems
\begin{align}
    \label{equ::ldg_stokes::stationaeres_stokes_system::stokes_system}
    \nabla p - \mu \Delta u &= f &\text{in } \Omega,
    	\notag \\
    \nabla \cdot u &= 0 &\text{in } \Omega,
    	\\
    u &= g_D &\text{auf } \partial \Omega.
    	\notag
\end{align}
Die Randwerte sollen dabei die Kompatibilitätsbedingung
\begin{align*}
%    \label{equ::ldg_stoke::stationaeres_stokes_system::randwertbedingung}
	\int\limits_{\partial \Omega}{g_D \cdot n \ds} = 0
\end{align*}
erfüllen, wobei $n\in \R^d$ die äussere Normale an $\Omega$ sei.
\end{definition}

Zur weiteren Betrachtung führen wir folgende Hilsvariable $\sigma$ ein
\begin{align*}
%	\label{equ::ldg_stokes::stationaeres_stokes_system::sigma}
    \sigma &:\Omega \mapsto \R^{d\times d}, &
		\\
    \sigma &:= \nabla u, &\text{(siehe auch \eqref{equ::ldg_stokes::schwache_form::notation_grad_u})}
\end{align*}
mit der wir \eqref{equ::ldg_stokes::stationaeres_stokes_system::stokes_system} als
ein System von Erhaltungsgleichungen schreiben können.

\begin{definition}[Stokes in Erhaltungsform]\label{definition::dlg_stokes::stokes_in_erhaltungsform}
Gesucht werden Funktionen $\sigma, u, p$ als Lösung von
\begin{subequations}
    \label{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen}
\begin{align}	
	\sigma &= \nabla u &\text{in } \Omega,
		\label{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::1} \\
	\nabla p - \mu \nabla\cdot \sigma &= f &\text{in } \Omega,
		\label{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::2} \\
	\nabla\cdot u &= 0 &\text{in } \Omega,
		\label{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::3} \\
	u &= g_D &\text{auf } \partial \Omega.
		\label{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::4}		
\end{align}
\end{subequations}
\end{definition}

\section{Schwache Formulierung}\label{section::ldg_stokes::schwache_lösung}

Bevor wir zur schwachen Formulierun von \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen}
übergehen können, benötigen wir noch einige Notationen.

\begin{definition}[Notation]\label{definition::ldg_stokes::notation}
Wir definieren\\
$\nabla v \in \R^{d\times d}\quad$für $v \in \R^d$ als
\begin{align}
	\label{equ::ldg_stokes::schwache_form::notation_grad_u}
	\left( \nabla v \right)_{i,j} &:= \partial_j v_i
			= \tfrac{\partial v_i}{\partial x_j},
\end{align}
$\nabla\cdot \sigma \in \R^d\quad$für $\sigma \in \R^{d\times d}$ als
\begin{align}
	\label{equ::ldg_stokes::schwache_form::notation_div_sigma}
	\left( \nabla\cdot \sigma \right)_i &:=
			\sum\limits_{j=1}^{d}{\partial_j \sigma_{ij}},
\end{align}
$v \otimes n \in \R^{d\times d}\quad$für $v,n \in \R^d$ als
\begin{align}
    \label{equ::ldg_stokes::schwache_form::notation_tensor}
    \left( v \otimes n \right)_{i,j} &:= v_i n_j,
\end{align}
$\sigma \myDdp \tau \in \R\quad$für $\sigma,\tau \in \R^{d\times d}$ als
\begin{align}
    \label{equ::ldg_stokes::schwache_form::notation_doppelpunkt}
    \sigma \myDdp \tau &:= \sum\limits_{i,j=1}^{d}{\sigma_{ij}\tau_{ij}}
\end{align}
und $v \myDot \sigma \myDot n \in \R\quad$für $v,n \in \R^d, \sigma \in \R^{d\times d}$ als
\begin{align}
    \label{equ::ldg_stokes::schwache_form::notation_v_sigma_n}
    v \myDot \sigma \myDot n &:= \sigma \myDdp \left( v \otimes n \right)
    		= \sum\limits_{i,j=1}^{d}{v_i \sigma_{ij} n_j}.
\end{align}
\end{definition}

Um zur schwachen Formulierung von \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen}
zu gelangen, multiplizieren wir die einzelnen Gleichungen
mit Testfunktionen $\tau \in \D(\omega)^{d\times d}$, $v \in \D(\omega)^d$ und
$q \in \D(\omega)$ und integrieren über eine beliebige Teilmenge $\omega \subset \Omega$.
Wir erhalten somit\\
aus Gleichung \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::1}
\begin{align}
	\label{equ::ldg_stokes::schwache_form::zur_schwachen_form::1}
    \int\limits_{\omega}{\sigma \myDdp \tau \dx} =
	\underbrace{
		\int\limits_{\omega}{\nabla u \cdot \tau \dx},
	}_{
		\overset{P.I.}{=} \int\limits_{\partial \omega}{u \cdot \tau \cdot n_{\omega} \ds}
		- \int\limits_{\omega}{u \cdot \left(\nabla \cdot \tau \right) \dx}
	}
\end{align}
aus Gleichung \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::2}
\begin{align}
    \label{equ::ldg_stokes::schwache_form::zur_schwachen_form::2}
	\int\limits_{\omega}{f\cdot v\dx} =
	\underbrace{
		\int\limits_{\omega}{\nabla p \cdot v \dx}
	}_{
		\overset{P.I.}{=} \int\limits_{\partial\omega}{p v\cdot n_{\omega}\ds}
		-\int\limits_{\omega}{p\left(\nabla\cdot v\right)\dx}
	}
	-\underbrace{
		\mu \int\limits_{\omega}{v \cdot \left(\nabla \cdot \sigma \right) \dx}
	}_{
		\overset{P.I.}{=} \int\limits_{\partial\omega}{v\cdot\sigma\cdot n_{\omega}\ds}
		-\int\limits_{\omega}{\sigma : \nabla v\dx}
	}
\end{align}
und aus Gleichung \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen::3}
\begin{align}
    \label{equ::ldg_stokes::schwache_form::zur_schwachen_form::3}
	0 =
	\underbrace{
		\int\limits_{\omega}{\left(\nabla\cdot u\right)q\dx}.
	}_{
		\overset{P.I.}{=}\int\limits_{\partial\omega}{u\cdot n_{\omega}q\ds}
		-\int\limits_{\omega}{u\cdot\nabla q\dx}
	}
\end{align}

Die Gleichungen \eqref{equ::ldg_stokes::schwache_form::zur_schwachen_form::1}-\eqref{equ::ldg_stokes::schwache_form::zur_schwachen_form::3} sind wohldefiniert für alle Funktionen $\left(\sigma,u,p\right)$,
$\left(\tau,v,q\right)\in\Sigma\times V\times Q$ und alle Elemente $T$ einer
Triangularisierung $\T$ von $\Omega$ (siehe auch Definition \ref{definition::ldg_stokes::triangularisierung}), wobei die Funktionenräume
$\Sigma$, $V$ und $Q$ definiert sind durch
\begin{align}
%	\label{equ::ldg_stokes::definition_funktionenraeume::sigma}
	\Sigma &:= \Big\{
		\sigma \in {L^{2}(\Omega)}^{d\times d}
	\quad\Big|\Big.\quad
		\sigma_{ij}{|}_{T}\in H^{1}(T),\quad\forall T\in\T, 0 \leq i,j < d
	\Big\},\\ \notag
%	\label{equ::ldg_stokes::definition_funktionenraeume::v}
	V &:= \Big\{
		v \in {L^{2}(\Omega)}^{d}
	\quad\Big|\Big.\quad
		v_{i}{|}_{T} \in H^{1}(T),\quad \forall T\in\T, 0 \leq i < d
	\Big\},\\ \notag
%	\label{equ::ldg_stokes::definition_funktionenraeume::q}
	Q &:= \Big\{
		q \in L^{2}(\Omega)
	\quad\Big|\Big.\quad
		q{|}_{T} \in H^{1}(T), \int\limits_{\Omega}{q\dx}=0,\quad \forall T\in\T
	\Big\}. \notag
\end{align}

Daher ist es sinnvoll, die exakte Lösung $\left(\sigma,u,p\right)$ durch
Funktionen $\left(\sigma_{N},u_{N},p_{N}\right)$ in den Finite Elemente
Räumen $\Sigma_{N}\times V_{N}\times Q_{N}\subset\Sigma\times V\times Q$
zu approximieren, wobei $\Sigma_{N}$, $V_{N}$ und $Q_{N}$ definiert sind durch
\begin{align}
	\label{equ::ldg_stokes::definition_funktionenraeume_diskret::sigma}
	\Sigma_{N} &:= \Big\{
		\sigma \in {L^{2}(\Omega)}^{d\times d}
	\quad\Big|\Big.\quad
		\sigma_{ij}{|}_{T}\in \mathcal{S}(T),\quad\forall T\in\T, 0 \leq i,j < d
	\Big\},\\
	\label{equ::ldg_stokes::definition_funktionenraeume_diskret::v}
	V_{N} &:= \Big\{
		v \in {L^{2}(\Omega)}^{d}
	\quad\Big|\Big.\quad
		v_{i}{|}_{T} \in \mathcal{V}(T),\quad \forall T\in\T, 0 \leq i < d
	\Big\},\\
	\label{equ::ldg_stokes::definition_funktionenraeume_diskret::q}
	Q_{N} &:= \Big\{
		q \in L^{2}(\Omega)
	\quad\Big|\Big.\quad
		q{|}_{T} \in \mathcal{Q}(T), \int\limits_{\Omega}{q\dx}=0,\quad \forall T\in\T
	\Big\}.
\end{align}
Dabei sind $\mathcal{S}(T),\mathcal{V}(V),\mathcal{Q}(T)$ lokale Finite Elemente
Räume, die üblicherweise aus Polynomen bestehen.

Die schwache Formulierung von \eqref{equ::ldg_stokes::stationaeres_stokes_system::erhaltungsgleichungen}
lautet dann

\begin{definition}[Schwache Formulierung]\label{definition::ldg_stokes::schwache_formulierung}
Sei $\T$ wie in \eqref{definition::ldg_stokes::triangularisierung} und $\Sigma$,
$V$ und $Q$ wie in \eqref{equ::ldg_stokes::definition_funktionenraeume_diskret::sigma}-\eqref{equ::ldg_stokes::definition_funktionenraeume_diskret::q}.
Gesucht sind Funktionen $\left(\sigma_{N},u_{N},p_{N}\right)\in\left(\Sigma_{N},V_{N},Q_{N}\right)$, sodass
\begin{subequations}
	\label{equ::ldg_stokes::schwache_formulierung}
\begin{align}
	\int\limits_{T}{\sigma_{N}\myDdp\tau\dx} &=
		\int\limits_{\partial T}{\hat{u}_{N_{\sigma}}\myDot\tau\myDot n_{T}\ds}
		-\int\limits_{T}{u_{N}\cdot\left(\nabla\cdot\tau\right)\dx}
		\label{equ::ldg_stokes::schwache_formulierung::1}\\
	\mu\int\limits_{T}{\sigma_{N}\myDdp\nabla v\dx} &-
		\mu\int\limits_{\partial T}{v\myDot\hat{\sigma}_{N}\myDot n_{T}\ds}
		-\int\limits_{T}{p_{N}\cdot\left(\nabla\cdot v\right)\dx}\\
	&+\int\limits_{\partial T}{\hat{p}_{N}\myDot v\myDot n_{T}\ds}
		=\int\limits_{T}{f\cdot v\dx}\notag\\
	\int\limits_{\partial T}{\hat{u}_{N_{p}}\cdot n_{T}q\ds}
		&-\int\limits_{T}{u_{N}\cdot\nabla q\dx}=0
\end{align}
\end{subequations}
$\forall \left(\tau,v,q\right) \in \Sigma_{N},V_{N},Q_{N}$ und $\forall T \in \T$.
Dabei werden die in \eqref{equ::ldg_stokes::schwache_form::zur_schwachen_form::1}-\eqref{equ::ldg_stokes::schwache_form::zur_schwachen_form::3}
auftretenden Spuren von $\sigma, u, p$ auf den Elementkanten $\partial T$ approximiert durch die Flüsse
$\hat{u}_{N_{\sigma}}$, $\hat{\sigma}_{N}$, $\hat{p}_{N}$ und $\hat{u}_{N_{p}}$.
\end{definition}

\begin{bemerkung}[Spur von $\sigma$, $u$, $p$]\label{bemerkung::ldg_stokes::spuren}
Die in den Randintegralen von \eqref{equ::ldg_stokes::schwache_formulierung}
vorkommende Flüsse $\hat{\sigma}_{N}$, $\hat{u}_{N_{\sigma}}$, $\hat{u}_{N_{p}}$ und $\hat{p}_{N}$
sind Approximationen der Spuren von $\sigma$, $u$ und $p$. Sie spielen eine zentrale
Rolle bei der LDG Diskretisierung. 
\end{bemerkung}

Um die Flüsse $\hat{\sigma}_{N}$, $\hat{u}_{N_{\sigma}}$, $\hat{u}_{N_{p}}$ und $\hat{p}_{N}$
genauer definieren zu können, benötigen wir noch einige Notation.

\begin{definition}[Triangularisierung]\label{definition::ldg_stokes::triangularisierung}
	Hierhin Infos zur Triangularisierung, incl.
\begin{align}
    \label{equ::ldg_stokes::triangularisierung}
    \Omega &= \bigcup\limits_{T\in\T}{T},\\\notag
    T_{i} &\cap T_{j} = \emptyset \quad\quad \forall i \neq j,\notag
\end{align}
und $E_{I}$, etc...
\end{definition}

\begin{definition}[Mittelwert, Sprung]\label{definition::ldg_stokes::mittelwerte_spruenge}
Sei $x \in \varepsilon$ ein Punkt auf einer Kante zwischen zwei Elementen $T_{+/-}$ der
Trinagularisierung $\T$. Sei $n^{+}$ die äussere Normale der Länge $1$ an $T_{+}$ in $x$
und $u^{+}$ der Wert von $u$ in $x$, gesehen von $T_{+}$ ($n^{-}$, $u^{-}$ entsprechend).\\
Dann sind die Mittelwerte von $\sigma$, $u$, $p$ definiert durch
\begin{align}\label{equ::ldg_stokes::mittelwerte}
    \meanLeft \sigma \meanRight &:= \tfrac{1}{2} \left(
    		\sigma^{+}+\sigma^{-}
    	\right) \in \R^{d \times d}
    	& \text{für } \sigma \in \R^{d \times d},\notag \\
    \meanLeft u \meanRight &:= \tfrac{1}{2} \left(
    		u^{+}+u^{-}
    	\right) \in \R^{d}
    	& \text{für } u \in \R^{d} \text{ und} \notag \\
    \meanLeft p \meanRight &:= \tfrac{1}{2} \left(
    		p^{+}+p^{-}
    	\right) \in \R
    	& \text{für } p \in \R \notag
\end{align}
und ihre Sprünge durch
\begin{align}%\label{equ::ldg_stokes::spruenge}
	\jumpLeft \sigma \jumpRight
		&:= \sigma^{+} \cdot n^{+} + \sigma^{-} \cdot n^{-} \in \R^{d}
		&\text{für } \sigma \in \R^{d \times d}, \notag \\
	\jumpLeft u \jumpRight
		&:= u^{+} \cdot n^{+} + u^{-} \cdot n^{-} \in \R
		&\text{für } u \in \R^{d}, \notag \\
	\underline{\jumpLeft u \jumpRight}
		&:= u^{+} \otimes n^{+} + u^{-} \otimes n^{-} \in \R^{d \times d}
		&\text{für } u \in \R^{d} \text{ und} \notag \\
	\jumpLeft p \jumpRight
		&:= p^{+} n^{+} + p^{-} n^{-} \in \R^{d}
		&\text{für } p \in \R. \notag
\end{align}
\end{definition}

Zu beachten ist, dass es zwei Sprünge für $u$ gibt, einen skalaren und einen
Matrixwertigen.
Mit dieser Notation können wir nun eine Wahl der Flüsse definieren, welche sich bei der Implementierung
durchgesetzt hat (siehe auch Cockburn).\\

\begin{beispiel}[Analytische Flüsse]\label{definition::ldg_stokes::analytische_fluesse}
Seien $C_{11}, D_{11} \in \R$, $C_{12}, D_{12} \in \R^{d}$. Wir bezeichnen
die inneren Kanten mit $\mathcal{E}_{I}$ und solche auf dem Rand von $\Omega$
mit $\mathcal{E}_{D}$. Dann sind die Flüsse gegeben durch\\
$\hat{\sigma}\left(u,\sigma\right): \Omega \rightarrow \R^{d \times d}$
\begin{align}%\label{equ::ldg_stokes::analytische_fluesse}
	\hat{\sigma}\left(u,\sigma\right) := \begin{cases}
			\meanLeft \sigma \meanRight - C_{11} \underline{\jumpLeft u \jumpRight} - \jumpLeft \sigma \jumpRight \otimes C_{12}
				&\text{auf } \mathcal{E}_{I}\\
			\sigma^{+} - C_{11} \left( u^{+} - g_{D} \right) \otimes n^{+}
				&\text{auf } \mathcal{E}_{D},
		\end{cases}
\end{align}
\end{beispiel}