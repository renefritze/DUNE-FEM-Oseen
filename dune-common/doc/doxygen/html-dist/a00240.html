<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>dune-common: singleton.hh Source File (dune-common )</title>
  <link rel="stylesheet" type="text/css" href="./dune-doxy.css">
  <link rel="stylesheet" type="text/css" href="./tabs.css">
</head>
<div class="main">
<div class="doxygen">
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_2ca904c6ce82cf2d3dcac8fdc6f434f6.html">common</a>
  </div>
</div>
<div class="contents">
<h1>singleton.hh</h1><a href="a00173.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef DUNE_SINGLETON_HH</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define DUNE_SINGLETON_HH</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <span class="keyword">namespace </span>Dune
<a name="l00011"></a>00011 {
<a name="l00048"></a>00048   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00049"></a><a class="code" href="a00114.html">00049</a>   <span class="keyword">class </span><a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>
<a name="l00050"></a>00050   {
<a name="l00051"></a>00051   <span class="keyword">public</span>:
<a name="l00056"></a><a class="code" href="a00115.html">00056</a>     <span class="keyword">class </span><a class="code" href="a00115.html" title="A simple smart pointer responsible for creation and deletion of the instance.">InstancePointer</a>
<a name="l00057"></a>00057     {
<a name="l00058"></a>00058     <span class="keyword">public</span>:
<a name="l00060"></a><a class="code" href="a00115.html#fb683211b10a69841c031bbb196312c6">00060</a>       <a class="code" href="a00115.html#fb683211b10a69841c031bbb196312c6" title="Construct a null pointer.">InstancePointer</a>() : pointer_(0)
<a name="l00061"></a>00061       {}
<a name="l00063"></a><a class="code" href="a00115.html#5b2eb5619b2243cf6f331989c5317f93">00063</a>       <a class="code" href="a00115.html#5b2eb5619b2243cf6f331989c5317f93" title="Delete the instance we point to.">~InstancePointer</a>()
<a name="l00064"></a>00064       {
<a name="l00065"></a>00065         <span class="keywordflow">if</span>(pointer_ != 0)
<a name="l00066"></a>00066           <span class="keyword">delete</span> pointer_;
<a name="l00067"></a>00067       }
<a name="l00072"></a><a class="code" href="a00115.html#54faa9090a3f49bacae263276220af54">00072</a>       T* <span class="keyword">get</span>()
<a name="l00073"></a>00073       {
<a name="l00074"></a>00074         <span class="keywordflow">return</span> pointer_;
<a name="l00075"></a>00075       }
<a name="l00080"></a><a class="code" href="a00115.html#1e4365cc876bc46f48f4c9cdbbad890c">00080</a>       <span class="keywordtype">void</span> <span class="keyword">set</span>(T* pointer)
<a name="l00081"></a>00081       {
<a name="l00082"></a>00082         <span class="keywordflow">if</span>(pointer != 0){
<a name="l00083"></a>00083           <span class="keyword">delete</span> pointer_;
<a name="l00084"></a>00084           pointer_ = pointer;
<a name="l00085"></a>00085         }
<a name="l00086"></a>00086       }
<a name="l00087"></a>00087     <span class="keyword">private</span>:
<a name="l00088"></a>00088       T* pointer_;
<a name="l00089"></a>00089     };
<a name="l00090"></a>00090   <span class="keyword">private</span>:
<a name="l00092"></a>00092     <span class="keyword">static</span> InstancePointer instance_;
<a name="l00093"></a>00093   <span class="keyword">protected</span>:
<a name="l00094"></a>00094     <span class="comment">/* @brief Private constructor. */</span>
<a name="l00095"></a>00095     <a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>(){}
<a name="l00097"></a><a class="code" href="a00114.html#bbdf8032c539aba0b695b060e2960df1">00097</a>     <a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>(<span class="keyword">const</span> <a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>&amp;){}
<a name="l00099"></a><a class="code" href="a00114.html#bcdd5e4726fe728275da632e5474bda9">00099</a>     <a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>&amp; <a class="code" href="a00114.html#bcdd5e4726fe728275da632e5474bda9" title="Private assignment operator.">operator=</a>(<span class="keyword">const</span> <a class="code" href="a00114.html" title="An adapter to turn a class into a singleton.">Singleton</a>&amp;){}
<a name="l00100"></a>00100     
<a name="l00101"></a>00101   <span class="keyword">public</span>:
<a name="l00106"></a><a class="code" href="a00114.html#3c25cc09ae67410c6133f7bf4e19fed2">00106</a>     <span class="keyword">static</span> T&amp; <a class="code" href="a00114.html#3c25cc09ae67410c6133f7bf4e19fed2" title="Get the instance of the singleton.">instance</a>()
<a name="l00107"></a>00107     {
<a name="l00108"></a>00108       <span class="keywordflow">if</span>(instance_.<a class="code" href="a00115.html#54faa9090a3f49bacae263276220af54" title="Get a pointer to the instance.">get</a>() == 0)
<a name="l00109"></a>00109         instance_.<a class="code" href="a00115.html#1e4365cc876bc46f48f4c9cdbbad890c" title="Set the pointer.">set</a>(<span class="keyword">new</span> T());
<a name="l00110"></a>00110       <span class="keywordflow">return</span> *instance_.<a class="code" href="a00115.html#54faa9090a3f49bacae263276220af54" title="Get a pointer to the instance.">get</a>();
<a name="l00111"></a>00111     }
<a name="l00112"></a>00112   };   
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
<a name="l00115"></a>00115   <span class="keyword">typename</span> Singleton&lt;T&gt;::InstancePointer Singleton&lt;T&gt;::instance_;
<a name="l00116"></a>00116   
<a name="l00117"></a>00117 } <span class="comment">// namespace Dune</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="preprocessor">#endif</span>
</pre></div></div>
</div> <!-- end doxygen -->
</div> <!-- end main -->
<div class="foot">

<p class="foot">
  Generated on 6 Nov 2008 with <a
  href="http://www.doxygen.org/">Doxygen</a> (ver 1.5.6)  
  [<a href="doxygen.log">logfile</a>].
</p>

</div>

</body>
</html>
