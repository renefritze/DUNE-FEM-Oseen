<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>dune-grid: sgrid.hh Source File (dune-grid )</title>
  <link rel="stylesheet" type="text/css" href="./dune-doxy.css">
  <link rel="stylesheet" type="text/css" href="./tabs.css">
</head>
<div class="main">
<div class="doxygen">
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_5edca94048dae04696b7e65d07cd8e9c.html">grid</a>
  </div>
</div>
<div class="contents">
<h1>sgrid.hh</h1><a href="a00447.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef DUNE_SGRID_HH</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define DUNE_SGRID_HH</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;limits&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;dune/common/fvector.hh&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;dune/common/fmatrix.hh&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;dune/common/stack.hh&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;dune/grid/common/capabilities.hh&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;dune/common/bigunsignedint.hh&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;dune/common/collectivecommunication.hh&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;dune/grid/common/grid.hh&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;dune/grid/sgrid/numbering.hh&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;dune/grid/common/indexidset.hh&gt;</span>
<a name="l00016"></a>00016 
<a name="l00022"></a>00022 <span class="keyword">namespace </span>Dune {
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">//************************************************************************</span>
<a name="l00028"></a><a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">00028</a> <span class="comment"></span>  <span class="keyword">typedef</span> <span class="keywordtype">double</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>; 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030   <span class="comment">// globally define the persistent index type</span>
<a name="l00031"></a>00031   <span class="keyword">const</span> <span class="keywordtype">int</span> sgrid_dim_bits = 24;   <span class="comment">// bits for encoding each dimension</span>
<a name="l00032"></a>00032   <span class="keyword">const</span> <span class="keywordtype">int</span> sgrid_level_bits = 6;  <span class="comment">// bits for encoding level number</span>
<a name="l00033"></a>00033   <span class="keyword">const</span> <span class="keywordtype">int</span> sgrid_codim_bits = 4;  <span class="comment">// bits for encoding codimension</span>
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">//************************************************************************</span>
<a name="l00036"></a>00036 <span class="comment">// forward declaration of templates</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimworld, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span><a class="code" href="a00260.html">SGeometry</a>;
<a name="l00039"></a>00039 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span><a class="code" href="a00255.html">SEntity</a>;
<a name="l00040"></a>00040 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span><a class="code" href="a00259.html">SEntityPointer</a>;
<a name="l00041"></a>00041 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, PartitionIteratorType, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span><a class="code" href="a00275.html">SLevelIterator</a>;
<a name="l00042"></a>00042 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimworld&gt; <span class="keyword">class </span><a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>;
<a name="l00043"></a>00043 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span><a class="code" href="a00273.html">SIntersectionIterator</a>;
<a name="l00044"></a>00044 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; <span class="keyword">class </span>SHierarchicIterator;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">//************************************************************************</span>
<a name="l00077"></a>00077 <span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">int</span> mydim, <span class="keywordtype">int</span> cdim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; 
<a name="l00078"></a><a class="code" href="a00260.html">00078</a> <span class="keyword">class </span><a class="code" href="a00260.html">SGeometry</a> : <span class="keyword">public</span> <a class="code" href="a00095.html" title="Default implementation for class Geometry.">GeometryDefaultImplementation</a>&lt;mydim,cdim,GridImp,SGeometry&gt;
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080 <span class="keyword">public</span>:
<a name="l00082"></a><a class="code" href="a00260.html#c800fd574ce576bf6cbf5af21b8ee0de">00082</a>         <span class="keyword">typedef</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a> <a class="code" href="a00260.html#c800fd574ce576bf6cbf5af21b8ee0de" title="define type used for coordinates in grid module">ctype</a>;
<a name="l00083"></a>00083 
<a name="l00085"></a>00085         GeometryType <a class="code" href="a00260.html#2d2d777486d31af4d4ab6200f3a9f2af" title="return the element type identifier">type</a> () <span class="keyword">const</span>;             
<a name="l00086"></a>00086 
<a name="l00088"></a>00088         <span class="keywordtype">int</span> <a class="code" href="a00260.html#fa402ab08ec0bc4a9cc871b34136c4da" title="return the number of corners of this element. Corners are numbered 0...n-1">corners</a> () <span class="keyword">const</span>;                  
<a name="l00089"></a>00089 
<a name="l00091"></a>00091         <span class="keyword">const</span> FieldVector&lt;sgrid_ctype, cdim&gt;&amp; <a class="code" href="a00260.html#bf211f59a327cd7f1fd4590721782de9" title="access to coordinates of corners. Index is the number of the corner">operator[] </a>(<span class="keywordtype">int</span> i) <span class="keyword">const</span>;
<a name="l00092"></a>00092 
<a name="l00094"></a>00094         FieldVector&lt;sgrid_ctype, cdim&gt; <a class="code" href="a00260.html#f16087442ed045dc89947056594c572e" title="maps a local coordinate within reference element to global coordinate in element">global</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, mydim&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>) <span class="keyword">const</span>;
<a name="l00095"></a>00095 
<a name="l00097"></a>00097         FieldVector&lt;sgrid_ctype, mydim&gt; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, cdim&gt;&amp; <a class="code" href="a00260.html#f16087442ed045dc89947056594c572e" title="maps a local coordinate within reference element to global coordinate in element">global</a>) <span class="keyword">const</span>;
<a name="l00098"></a>00098 
<a name="l00100"></a>00100         <span class="keywordtype">bool</span> <a class="code" href="a00260.html#6d9e9af1e1b53337f38b85e1fde3f245" title="returns true if the point in local coordinates is located within the refelem">checkInside</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, mydim&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>) <span class="keyword">const</span>;
<a name="l00101"></a>00101   
<a name="l00121"></a>00121         <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a> <a class="code" href="a00260.html#7727ffc63314110f25af1866b518bd84">integrationElement</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, mydim&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>) <span class="keyword">const</span>;
<a name="l00122"></a>00122 
<a name="l00124"></a>00124         <span class="keyword">const</span> FieldMatrix&lt;sgrid_ctype,mydim,mydim&gt;&amp; <a class="code" href="a00260.html#0c33ba4e3bbe5c7c6deb4769e42f87a6" title="can only be called for dim=dimworld!">jacobianInverseTransposed</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, mydim&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>) <span class="keyword">const</span>;
<a name="l00125"></a>00125 
<a name="l00127"></a>00127         <span class="keywordtype">void</span> <a class="code" href="a00260.html#c81f127fbc7d6f5f87cd1c6aa9057c9f" title="print internal data">print</a> (std::ostream&amp; ss, <span class="keywordtype">int</span> indent) <span class="keyword">const</span>;
<a name="l00128"></a>00128 
<a name="l00133"></a>00133         <span class="keywordtype">void</span> <a class="code" href="a00260.html#b40318f5f7453404d80246102998f59b">make</a> (FieldMatrix&lt;sgrid_ctype,mydim+1,cdim&gt;&amp; __As);
<a name="l00134"></a>00134 
<a name="l00136"></a><a class="code" href="a00260.html#9a3691216b656cf8e37ef7b24fcdac44">00136</a>         <a class="code" href="a00260.html#9a3691216b656cf8e37ef7b24fcdac44" title="constructor">SGeometry</a> () : builtinverse(false) {};
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="keyword">private</span>:
<a name="l00139"></a>00139         FieldVector&lt;sgrid_ctype, cdim&gt; s;         
<a name="l00140"></a>00140         FieldMatrix&lt;sgrid_ctype,mydim,cdim&gt; A;     
<a name="l00141"></a>00141         array&lt;FieldVector&lt;sgrid_ctype, cdim&gt;, 1&lt;&lt;mydim&gt; c; 
<a name="l00142"></a>00142         <span class="keyword">mutable</span> FieldMatrix&lt;sgrid_ctype,mydim,mydim&gt; Jinv;       
<a name="l00143"></a>00143         <span class="keyword">mutable</span> <span class="keywordtype">bool</span> builtinverse;
<a name="l00144"></a>00144 };
<a name="l00145"></a>00145 
<a name="l00147"></a>00147 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cdim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; 
<a name="l00148"></a><a class="code" href="a00261.html">00148</a> <span class="keyword">class </span><a class="code" href="a00260.html">SGeometry</a>&lt;0,cdim,GridImp&gt; : <span class="keyword">public</span> <a class="code" href="a00095.html" title="Default implementation for class Geometry.">GeometryDefaultImplementation</a>&lt;0,cdim,GridImp,SGeometry&gt;
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150 <span class="keyword">public</span>:
<a name="l00152"></a><a class="code" href="a00261.html#dd821707dec83793a8d0ab14aa7e508f">00152</a>         <span class="keyword">typedef</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a> <a class="code" href="a00260.html#c800fd574ce576bf6cbf5af21b8ee0de" title="define type used for coordinates in grid module">ctype</a>;
<a name="l00153"></a>00153 
<a name="l00155"></a>00155         GeometryType <a class="code" href="a00260.html#2d2d777486d31af4d4ab6200f3a9f2af" title="return the element type identifier">type</a> () <span class="keyword">const</span>;             
<a name="l00156"></a>00156 
<a name="l00158"></a>00158         <span class="keywordtype">int</span> <a class="code" href="a00260.html#fa402ab08ec0bc4a9cc871b34136c4da" title="return the number of corners of this element. Corners are numbered 0...n-1">corners</a> () <span class="keyword">const</span>;
<a name="l00159"></a>00159 
<a name="l00161"></a>00161         <span class="keyword">const</span> FieldVector&lt;sgrid_ctype, cdim&gt;&amp; <a class="code" href="a00260.html#bf211f59a327cd7f1fd4590721782de9" title="access to coordinates of corners. Index is the number of the corner">operator[] </a>(<span class="keywordtype">int</span> i) <span class="keyword">const</span>;
<a name="l00162"></a>00162 
<a name="l00164"></a>00164         <span class="keywordtype">void</span> <a class="code" href="a00260.html#c81f127fbc7d6f5f87cd1c6aa9057c9f" title="print internal data">print</a> (std::ostream&amp; ss, <span class="keywordtype">int</span> indent) <span class="keyword">const</span>;
<a name="l00165"></a>00165 
<a name="l00167"></a>00167         <span class="keywordtype">void</span> <a class="code" href="a00260.html#b40318f5f7453404d80246102998f59b">make</a> (FieldMatrix&lt;sgrid_ctype,1,cdim&gt;&amp; __As);
<a name="l00168"></a>00168 
<a name="l00170"></a><a class="code" href="a00261.html#7e092083dc1e8afaca6348ef58c71a05">00170</a>         FieldVector&lt;sgrid_ctype, cdim&gt; <a class="code" href="a00260.html#f16087442ed045dc89947056594c572e" title="maps a local coordinate within reference element to global coordinate in element">global</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, 0&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00260.html#bf211f59a327cd7f1fd4590721782de9" title="access to coordinates of corners. Index is the number of the corner">operator[] </a>(0); }
<a name="l00171"></a>00171 
<a name="l00173"></a><a class="code" href="a00261.html#2a9781392619d66c1293496196ec2dfb">00173</a>         FieldVector&lt;sgrid_ctype, 0&gt; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, cdim&gt;&amp; <a class="code" href="a00260.html#f16087442ed045dc89947056594c572e" title="maps a local coordinate within reference element to global coordinate in element">global</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> FieldVector&lt;sgrid_ctype,0&gt; (0.0); } 
<a name="l00174"></a>00174 
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="a00261.html#debdef29bc281c46b2f8cd0d808beb01">00197</a>         <a class="code" href="a00260.html#9a3691216b656cf8e37ef7b24fcdac44" title="constructor">SGeometry</a> () {};
<a name="l00198"></a>00198 
<a name="l00204"></a><a class="code" href="a00261.html#243ad385a21ca8d55a0991abaeb6eeef">00204</a>         <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a> <a class="code" href="a00260.html#7727ffc63314110f25af1866b518bd84">integrationElement</a>(<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, 0&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>)<span class="keyword"> const </span>{
<a name="l00205"></a>00205             <span class="keywordflow">return</span> 1.;
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207         
<a name="l00209"></a><a class="code" href="a00261.html#6679669c636333e268abe64a9dd6a17c">00209</a>         <span class="keywordtype">bool</span> <a class="code" href="a00260.html#6d9e9af1e1b53337f38b85e1fde3f245" title="returns true if the point in local coordinates is located within the refelem">checkInside</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, 0&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>)<span class="keyword"> const </span>
<a name="l00210"></a>00210 <span class="keyword">        </span>{
<a name="l00211"></a>00211           <span class="keywordflow">return</span> <span class="keyword">true</span>; 
<a name="l00212"></a>00212         }
<a name="l00213"></a>00213   
<a name="l00215"></a><a class="code" href="a00261.html#eaec8b11a2a6e85f70df827ab53949c3">00215</a>         <span class="keyword">const</span> FieldMatrix&lt;sgrid_ctype,0,0&gt;&amp; <a class="code" href="a00260.html#0c33ba4e3bbe5c7c6deb4769e42f87a6" title="can only be called for dim=dimworld!">jacobianInverseTransposed</a> (<span class="keyword">const</span> FieldVector&lt;sgrid_ctype, 0&gt;&amp; <a class="code" href="a00260.html#d20ab465f54e0b237d71b423c646a365" title="maps a global coordinate within the element to a local coordinate in its reference...">local</a>)<span class="keyword"> const</span>
<a name="l00216"></a>00216 <span class="keyword">        </span>{
<a name="l00217"></a>00217           <span class="keyword">static</span> FieldMatrix&lt;sgrid_ctype,0,0&gt; dummy; 
<a name="l00218"></a>00218           <span class="keywordflow">return</span> dummy;
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="keyword">protected</span>:
<a name="l00222"></a><a class="code" href="a00261.html#114464496cded524a0846f9d861fd5ab">00222</a>         FieldVector&lt;sgrid_ctype, cdim&gt; s;         
<a name="l00223"></a>00223 };
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> mydim, <span class="keywordtype">int</span> cdim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00226"></a>00226 <span class="keyword">inline</span> std::ostream&amp; operator&lt;&lt; (std::ostream&amp; s, SGeometry&lt;mydim,cdim,GridImp&gt;&amp; e)
<a name="l00227"></a>00227 {
<a name="l00228"></a>00228         e.print(s,0);
<a name="l00229"></a>00229         <span class="keywordflow">return</span> s;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> mydim, <span class="keywordtype">int</span> cdim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00233"></a>00233 <span class="keyword">class </span>SMakeableGeometry : <span class="keyword">public</span> Geometry&lt;mydim, cdim, GridImp, SGeometry&gt;
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235 <span class="keyword">public</span>:
<a name="l00236"></a>00236   SMakeableGeometry() :
<a name="l00237"></a>00237     Geometry&lt;mydim, cdim, GridImp, SGeometry&gt;(SGeometry&lt;mydim, cdim, GridImp&gt;())
<a name="l00238"></a>00238     {};
<a name="l00239"></a>00239 
<a name="l00240"></a>00240     <span class="keywordtype">void</span> make (FieldMatrix&lt;sgrid_ctype,mydim+1,cdim&gt;&amp; __As) { this-&gt;realGeometry.make(__As); }
<a name="l00241"></a>00241 };
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="comment">//************************************************************************</span>
<a name="l00248"></a>00248 <span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00249"></a><a class="code" href="a00258.html">00249</a> <span class="keyword">class </span><a class="code" href="a00258.html">SEntityBase</a> {
<a name="l00250"></a>00250   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00259.html">SEntityPointer</a>&lt;codim,GridImp&gt;;
<a name="l00251"></a>00251   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00273.html">SIntersectionIterator</a>&lt;GridImp&gt;;
<a name="l00252"></a>00252   <span class="keyword">enum</span> { dimworld = GridImp::dimensionworld };
<a name="l00253"></a>00253 <span class="keyword">public</span>:
<a name="l00254"></a>00254   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;codim&gt;::Geometry <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>;
<a name="l00255"></a>00255   <span class="keyword">typedef</span> SMakeableGeometry&lt;dim-codim, dimworld, <span class="keyword">const</span> GridImp&gt; MakeableGeometry;
<a name="l00256"></a>00256   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::PersistentIndexType PersistentIndexType;
<a name="l00257"></a>00257 
<a name="l00259"></a><a class="code" href="a00258.html#39ae33eca20f6f8220aa71d133c48a79">00259</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#39ae33eca20f6f8220aa71d133c48a79" title="level of this element">level</a> ()<span class="keyword"> const</span>
<a name="l00260"></a>00260 <span class="keyword">    </span>{
<a name="l00261"></a>00261       <span class="keywordflow">return</span> <a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>;
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263   
<a name="l00266"></a><a class="code" href="a00258.html#4fb2536d1446e8e3d97bc45a173efb03">00266</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#4fb2536d1446e8e3d97bc45a173efb03">index</a> ()<span class="keyword"> const</span>
<a name="l00267"></a>00267 <span class="keyword">    </span>{
<a name="l00268"></a>00268       <span class="keywordflow">return</span> <a class="code" href="a00258.html#4783229cf790de83eb6c4eadef0e2f18" title="consecutive, codim-wise, level-wise index">compressedIndex</a>();
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270   
<a name="l00272"></a>00272   <span class="keywordtype">int</span> <a class="code" href="a00258.html#4b710086edbbfa16738062c03c6e2fc3" title="global index is calculated from the index and grid size">globalIndex</a>() <span class="keyword">const</span>;
<a name="l00273"></a>00273   
<a name="l00275"></a>00275   <span class="keyword">const</span> <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>&amp; <a class="code" href="a00258.html#378ac44fbfc29ce02bc74b24924d04cc" title="geometry of this entity">geometry</a> () <span class="keyword">const</span>;
<a name="l00276"></a>00276   
<a name="l00278"></a>00278   <a class="code" href="a00258.html">SEntityBase</a> (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id);
<a name="l00279"></a>00279   <a class="code" href="a00258.html">SEntityBase</a> ();
<a name="l00280"></a>00280   <span class="keywordtype">void</span> make (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id);
<a name="l00281"></a>00281 
<a name="l00283"></a>00283   <span class="keywordtype">void</span> make (<span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id);
<a name="l00284"></a>00284 
<a name="l00286"></a><a class="code" href="a00258.html#775e3bce21078da0c45dbafd9ee375fd">00286</a>   PersistentIndexType <a class="code" href="a00258.html#775e3bce21078da0c45dbafd9ee375fd" title="globally unique, persistent index">persistentIndex</a> ()<span class="keyword"> const </span>
<a name="l00287"></a>00287 <span class="keyword">    </span>{ 
<a name="l00288"></a>00288           <span class="keywordflow">if</span> (codim!=dim)
<a name="l00289"></a>00289                 {
<a name="l00290"></a>00290                   <span class="comment">// encode codim, this would actually not be necessary</span>
<a name="l00291"></a>00291           <span class="comment">// because z is unique in codim</span>
<a name="l00292"></a>00292                   PersistentIndexType <a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c" title="my consecutive id">id</a>(codim);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294                   <span class="comment">// encode level</span>
<a name="l00295"></a>00295                   <span class="keywordtype">id</span> = <span class="keywordtype">id</span> &lt;&lt; sgrid_level_bits;
<a name="l00296"></a>00296                   <span class="keywordtype">id</span> = <span class="keywordtype">id</span>+PersistentIndexType(<a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>);
<a name="l00297"></a>00297         
<a name="l00298"></a>00298                   <span class="comment">// encode coordinates</span>
<a name="l00299"></a>00299                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=dim-1; i&gt;=0; i--)
<a name="l00300"></a>00300                         {
<a name="l00301"></a>00301                           <span class="keywordtype">id</span> = <span class="keywordtype">id</span> &lt;&lt; sgrid_dim_bits;
<a name="l00302"></a>00302                           <span class="keywordtype">id</span> = <span class="keywordtype">id</span>+PersistentIndexType(<a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165" title="my coordinate, number of even components = codim">z</a>[i]);
<a name="l00303"></a>00303                         }
<a name="l00304"></a>00304                   
<a name="l00305"></a>00305                   <span class="keywordflow">return</span> id;
<a name="l00306"></a>00306                 }
<a name="l00307"></a>00307           <span class="keywordflow">else</span>
<a name="l00308"></a>00308                 {
<a name="l00309"></a>00309                   <span class="comment">// determine min number of trailing zeroes</span>
<a name="l00310"></a>00310                   <span class="comment">// consider that z is on the doubled grid !</span>
<a name="l00311"></a>00311                   <span class="keywordtype">int</span> trailing = 1000;
<a name="l00312"></a>00312                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dim; i++)
<a name="l00313"></a>00313                         {
<a name="l00314"></a>00314                           <span class="comment">// count trailing zeros</span>
<a name="l00315"></a>00315                           <span class="keywordtype">int</span> zeros = 0;
<a name="l00316"></a>00316                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>; j++)
<a name="l00317"></a>00317                                 <span class="keywordflow">if</span> (<a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165" title="my coordinate, number of even components = codim">z</a>[i]&amp;(1&lt;&lt;(j+1)))
<a name="l00318"></a>00318                                   <span class="keywordflow">break</span>;
<a name="l00319"></a>00319                                 <span class="keywordflow">else</span>
<a name="l00320"></a>00320                                   zeros++;
<a name="l00321"></a>00321                           trailing = std::min(trailing,zeros);
<a name="l00322"></a>00322                         }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324                   <span class="comment">// determine the level of this vertex</span>
<a name="l00325"></a>00325                   <span class="keywordtype">int</span> <a class="code" href="a00258.html#39ae33eca20f6f8220aa71d133c48a79" title="level of this element">level</a> = <a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>-trailing;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327                   <span class="comment">// encode codim</span>
<a name="l00328"></a>00328                   PersistentIndexType <a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c" title="my consecutive id">id</a>(dim);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330                   <span class="comment">// encode level</span>
<a name="l00331"></a>00331                   <span class="keywordtype">id</span> = <span class="keywordtype">id</span> &lt;&lt; sgrid_level_bits;
<a name="l00332"></a>00332                   <span class="keywordtype">id</span> = <span class="keywordtype">id</span>+PersistentIndexType(level);
<a name="l00333"></a>00333         
<a name="l00334"></a>00334                   <span class="comment">// encode coordinates</span>
<a name="l00335"></a>00335                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=dim-1; i&gt;=0; i--)
<a name="l00336"></a>00336                         {
<a name="l00337"></a>00337                           <span class="keywordtype">id</span> = <span class="keywordtype">id</span> &lt;&lt; sgrid_dim_bits;
<a name="l00338"></a>00338                           <span class="keywordtype">id</span> = <span class="keywordtype">id</span>+PersistentIndexType(<a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165" title="my coordinate, number of even components = codim">z</a>[i]&gt;&gt;trailing);
<a name="l00339"></a>00339                         }
<a name="l00340"></a>00340         
<a name="l00341"></a>00341                   <span class="keywordflow">return</span> id;
<a name="l00342"></a>00342                 }
<a name="l00343"></a>00343     }
<a name="l00344"></a>00344 
<a name="l00346"></a><a class="code" href="a00258.html#4783229cf790de83eb6c4eadef0e2f18">00346</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#4783229cf790de83eb6c4eadef0e2f18" title="consecutive, codim-wise, level-wise index">compressedIndex</a> ()<span class="keyword"> const</span>
<a name="l00347"></a>00347 <span class="keyword">    </span>{
<a name="l00348"></a>00348                 <span class="keywordflow">return</span> <a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c" title="my consecutive id">id</a>;
<a name="l00349"></a>00349     }
<a name="l00350"></a>00350 
<a name="l00352"></a><a class="code" href="a00258.html#afbb78371c70ff780ac663ce0de6f5c0">00352</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#afbb78371c70ff780ac663ce0de6f5c0" title="consecutive, codim-wise, level-wise index">compressedLeafIndex</a> ()<span class="keyword"> const</span>
<a name="l00353"></a>00353 <span class="keyword">    </span>{
<a name="l00354"></a>00354           <span class="comment">// codim != dim -&gt; there are no copies of entities</span>
<a name="l00355"></a>00355           <span class="comment">// maxlevel -&gt; ids are fine</span>
<a name="l00356"></a>00356           <span class="keywordflow">if</span> (codim&lt;dim || l==grid-&gt;maxLevel())
<a name="l00357"></a>00357                 <span class="keywordflow">return</span> <a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c" title="my consecutive id">id</a>;
<a name="l00358"></a>00358           
<a name="l00359"></a>00359           <span class="comment">// this is a vertex which is not on the finest level</span>
<a name="l00360"></a>00360           <span class="comment">// move coordinates up to maxlevel (multiply by 2 for each level</span>
<a name="l00361"></a>00361           array&lt;int,dim&gt; coord;
<a name="l00362"></a>00362           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;dim; k++)
<a name="l00363"></a>00363                 coord[k] = <a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165" title="my coordinate, number of even components = codim">z</a>[k]*(1&lt;&lt;(<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;maxLevel()-<a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>));
<a name="l00364"></a>00364 
<a name="l00365"></a>00365           <span class="comment">// compute number with respect to maxLevel</span>
<a name="l00366"></a>00366           <span class="keywordflow">return</span> <a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;n(<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;maxLevel(),coord);
<a name="l00367"></a>00367     }
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 <span class="keyword">protected</span>:
<a name="l00370"></a>00370   <span class="comment">// this is how we implement our elements</span>
<a name="l00371"></a><a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918">00371</a>   GridImp* <a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>;         
<a name="l00372"></a><a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6">00372</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#443e5db229a4264341b8886755efe0c6" title="level where element is on">l</a>;                 
<a name="l00373"></a><a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c">00373</a>   <span class="keywordtype">int</span> <a class="code" href="a00258.html#c901efafad4f710eef0afb32874ba42c" title="my consecutive id">id</a>;                
<a name="l00374"></a><a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165">00374</a>   array&lt;int,dim&gt; <a class="code" href="a00258.html#177a4a6c6cb74fa52d4a24696b254165" title="my coordinate, number of even components = codim">z</a>; 
<a name="l00375"></a><a class="code" href="a00258.html#254bca04fc66d49eb44d84d4f761c5bc">00375</a>   <span class="keyword">mutable</span> MakeableGeometry <a class="code" href="a00258.html#254bca04fc66d49eb44d84d4f761c5bc" title="geometry, is only built on demand">geo</a>; 
<a name="l00376"></a><a class="code" href="a00258.html#221fd8119ef6b7b799ce9e0dd3aa1a08">00376</a>   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> <a class="code" href="a00258.html#221fd8119ef6b7b799ce9e0dd3aa1a08" title="true if geometry has been constructed">builtgeometry</a>;   
<a name="l00377"></a>00377 };
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 
<a name="l00387"></a>00387 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; 
<a name="l00388"></a><a class="code" href="a00255.html">00388</a> <span class="keyword">class </span><a class="code" href="a00255.html">SEntity</a> : <span class="keyword">public</span> <a class="code" href="a00258.html">SEntityBase</a>&lt;codim,dim,GridImp&gt;, 
<a name="l00389"></a>00389                 <span class="keyword">public</span> <a class="code" href="a00085.html" title="Default Implementations for EntityImp.">EntityDefaultImplementation</a>&lt;codim,dim,GridImp,SEntity&gt;
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391   <span class="keyword">enum</span> { dimworld = GridImp::dimensionworld };
<a name="l00392"></a>00392 <span class="keyword">public</span>:
<a name="l00393"></a>00393   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;codim&gt;::Geometry <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>;
<a name="l00394"></a>00394   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;codim&gt;::LevelIterator <a class="code" href="a00206.html" title="Enables iteration over all entities of a given codimension and level of a grid. See...">LevelIterator</a>;
<a name="l00395"></a>00395   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::LeafIntersectionIterator <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a>;
<a name="l00396"></a>00396   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::HierarchicIterator <a class="code" href="a00140.html" title="Enables iteration over all codim zero entities in a subtree See also the documentation...">HierarchicIterator</a>;
<a name="l00397"></a>00397   
<a name="l00398"></a>00398   <span class="comment">// disambiguate member functions with the same name in both bases</span>
<a name="l00400"></a><a class="code" href="a00255.html#52a4ae66e39cc96e4666ea4bb2d3ca1f">00400</a> <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="a00255.html#52a4ae66e39cc96e4666ea4bb2d3ca1f" title="level of this element">level</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;codim,dim,GridImp&gt;::level</a>();}
<a name="l00401"></a>00401   
<a name="l00403"></a><a class="code" href="a00255.html#c5139347864b9768e5e3cd62abc53553">00403</a>   <span class="keywordtype">int</span> <a class="code" href="a00255.html#c5139347864b9768e5e3cd62abc53553" title="index is unique and consecutive per level and codim used for access to degrees of...">index</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;codim,dim,GridImp&gt;::index</a>();}
<a name="l00404"></a>00404 
<a name="l00406"></a><a class="code" href="a00255.html#bbf9d0372ca40afa1713043cd01eb7ce">00406</a>   <span class="keyword">const</span> <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>&amp; <a class="code" href="a00255.html#bbf9d0372ca40afa1713043cd01eb7ce" title="geometry of this entity">geometry</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;codim,dim,GridImp&gt;::geometry</a>(); }
<a name="l00407"></a>00407   
<a name="l00409"></a><a class="code" href="a00255.html#9df1ca16ac8e26f907238e62d1a1a482">00409</a>   <a class="code" href="a00492.html#gbd89b77709db1d9e56bb17cd0aa44c3d" title="Attributes used in the generic overlap model.">PartitionType</a> <a class="code" href="a00255.html#9df1ca16ac8e26f907238e62d1a1a482" title="only interior entities">partitionType</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="a00492.html#ggbd89b77709db1d9e56bb17cd0aa44c3d1cdad324759fb0e56c7f035d91f7e4b8" title="all interior entities">InteriorEntity</a>; }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411   <span class="comment">// specific to SEntity</span>
<a name="l00413"></a><a class="code" href="a00255.html#94a75c0ee4a775614cdbbb57e3b109d9">00413</a> <span class="comment"></span>  <a class="code" href="a00255.html#94a75c0ee4a775614cdbbb57e3b109d9" title="constructor">SEntity</a> (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) : <a class="code" href="a00258.html">SEntityBase</a>&lt;codim,dim,GridImp&gt;::<a class="code" href="a00258.html">SEntityBase</a>(_grid,_l,_id) {};
<a name="l00414"></a>00414 };
<a name="l00415"></a>00415 
<a name="l00442"></a>00442 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00443"></a><a class="code" href="a00256.html">00443</a> <span class="keyword">class </span><a class="code" href="a00255.html">SEntity</a>&lt;0,dim,GridImp&gt; : <span class="keyword">public</span> <a class="code" href="a00258.html">SEntityBase</a>&lt;0,dim,GridImp&gt;, 
<a name="l00444"></a>00444                                <span class="keyword">public</span> <a class="code" href="a00085.html" title="Default Implementations for EntityImp.">EntityDefaultImplementation</a>&lt;0,dim,GridImp,SEntity&gt;
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446   <span class="keyword">enum</span> { dimworld = GridImp::dimensionworld };
<a name="l00447"></a>00447 <span class="keyword">public</span>:
<a name="l00448"></a>00448   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::Geometry <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>;
<a name="l00449"></a>00449   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::LocalGeometry LocalGeometry;
<a name="l00450"></a>00450   <span class="keyword">typedef</span> SMakeableGeometry&lt;dim, dimworld, const GridImp&gt; MakeableGeometry;
<a name="l00451"></a>00451   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> cd&gt;
<a name="l00452"></a>00452   <span class="keyword">struct </span>Codim
<a name="l00453"></a>00453   {
<a name="l00454"></a>00454     <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;cd&gt;::EntityPointer <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a>;
<a name="l00455"></a>00455   };
<a name="l00456"></a>00456   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::EntityPointer <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a>;
<a name="l00457"></a>00457   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::LeafIntersectionIterator <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a>;
<a name="l00458"></a>00458   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::HierarchicIterator <a class="code" href="a00140.html" title="Enables iteration over all codim zero entities in a subtree See also the documentation...">HierarchicIterator</a>;
<a name="l00459"></a>00459   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::PersistentIndexType PersistentIndexType;
<a name="l00460"></a>00460 
<a name="l00462"></a><a class="code" href="a00256.html#77a57ec1ce17c09978aa513039193789">00462</a>   <span class="keyword">friend</span> <span class="keyword">class </span>SHierarchicIterator&lt;GridImp&gt;;
<a name="l00463"></a>00463   
<a name="l00464"></a>00464   <span class="comment">// disambiguate member functions with the same name in both bases</span>
<a name="l00466"></a><a class="code" href="a00256.html#ba48fa561c2ca048c2dfd39c9d62cf82">00466</a> <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="a00255.html#52a4ae66e39cc96e4666ea4bb2d3ca1f" title="level of this element">level</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;0,dim,GridImp&gt;::level</a>();}
<a name="l00467"></a>00467   
<a name="l00470"></a><a class="code" href="a00256.html#b55691990e741efbf18dccf3b4728cf4">00470</a>   <span class="keywordtype">int</span> <a class="code" href="a00255.html#c5139347864b9768e5e3cd62abc53553" title="index is unique and consecutive per level and codim used for access to degrees of...">index</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;0,dim,GridImp&gt;::index</a>();}
<a name="l00471"></a>00471   
<a name="l00473"></a><a class="code" href="a00256.html#ee8a743d8b3919e1a643d240ae7aeb7f">00473</a>   <a class="code" href="a00492.html#gbd89b77709db1d9e56bb17cd0aa44c3d" title="Attributes used in the generic overlap model.">PartitionType</a> <a class="code" href="a00255.html#9df1ca16ac8e26f907238e62d1a1a482" title="only interior entities">partitionType</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="a00492.html#ggbd89b77709db1d9e56bb17cd0aa44c3d1cdad324759fb0e56c7f035d91f7e4b8" title="all interior entities">InteriorEntity</a>; }
<a name="l00474"></a>00474 
<a name="l00476"></a><a class="code" href="a00256.html#a7b481ac0515cbe97e6c2204171da932">00476</a>   <span class="keyword">const</span> <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>&amp; <a class="code" href="a00255.html#bbf9d0372ca40afa1713043cd01eb7ce" title="geometry of this entity">geometry</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;0,dim,GridImp&gt;::geometry</a>();}
<a name="l00477"></a>00477 
<a name="l00482"></a>00482   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt; <span class="keywordtype">int</span> count () <span class="keyword">const</span>; 
<a name="l00483"></a>00483 
<a name="l00488"></a>00488   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt; <span class="keyword">typename</span> Codim&lt;cc&gt;::EntityPointer entity (<span class="keywordtype">int</span> i) <span class="keyword">const</span>;
<a name="l00489"></a>00489 
<a name="l00491"></a>00491   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l00492"></a><a class="code" href="a00256.html#cf99f865b3c3d0f7add699e5099d6d6e">00492</a>   <span class="keywordtype">int</span> subCompressedIndex (<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00493"></a>00493 <span class="keyword">  </span>{
<a name="l00494"></a>00494         <span class="keywordflow">if</span> (cc==0) <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#4783229cf790de83eb6c4eadef0e2f18" title="consecutive, codim-wise, level-wise index">compressedIndex</a>();
<a name="l00495"></a>00495         <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;template getRealEntity&lt;cc&gt;(*entity&lt;cc&gt;(i)).compressedIndex();
<a name="l00496"></a>00496   }
<a name="l00497"></a>00497 
<a name="l00499"></a>00499   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l00500"></a><a class="code" href="a00256.html#23449569f7ec9a94ed07278c414aa5b4">00500</a>   <span class="keywordtype">int</span> subCompressedLeafIndex (<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00501"></a>00501 <span class="keyword">  </span>{
<a name="l00502"></a>00502         <span class="keywordflow">if</span> (cc==0) <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#afbb78371c70ff780ac663ce0de6f5c0" title="consecutive, codim-wise, level-wise index">compressedLeafIndex</a>();
<a name="l00503"></a>00503         <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;template getRealEntity&lt;cc&gt;(*entity&lt;cc&gt;(i)).compressedLeafIndex();
<a name="l00504"></a>00504   }
<a name="l00505"></a>00505 
<a name="l00507"></a>00507   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l00508"></a><a class="code" href="a00256.html#457bf6901146918d67a2061440d1ce73">00508</a>   PersistentIndexType subPersistentIndex (<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00509"></a>00509 <span class="keyword">  </span>{
<a name="l00510"></a>00510         <span class="keywordflow">if</span> (cc==0) <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#775e3bce21078da0c45dbafd9ee375fd" title="globally unique, persistent index">persistentIndex</a>();
<a name="l00511"></a>00511         <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;template getRealEntity&lt;cc&gt;(*entity&lt;cc&gt;(i)).persistentIndex();
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513   
<a name="l00521"></a>00521   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> ibegin () <span class="keyword">const</span>;
<a name="l00522"></a>00522   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> ileafbegin () <span class="keyword">const</span>;
<a name="l00523"></a>00523   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> ilevelbegin () <span class="keyword">const</span>;
<a name="l00525"></a>00525   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> iend () <span class="keyword">const</span>;
<a name="l00526"></a>00526   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> ileafend () <span class="keyword">const</span>;
<a name="l00527"></a>00527   <a class="code" href="a00154.html" title="Mesh entities of codimension 0 (&amp;quot;elements&amp;quot;) allow to visit all intersections...">IntersectionIterator</a> ilevelend () <span class="keyword">const</span>;
<a name="l00528"></a>00528 
<a name="l00534"></a>00534   <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a> father () <span class="keyword">const</span>;
<a name="l00535"></a>00535 
<a name="l00537"></a><a class="code" href="a00256.html#844fb44d9a6a6269ea8e93e8631ae054">00537</a>   <span class="keywordtype">bool</span> isLeaf ()<span class="keyword"> const</span>
<a name="l00538"></a>00538 <span class="keyword">    </span>{
<a name="l00539"></a>00539       <span class="keywordflow">return</span> ( this-&gt;<a class="code" href="a00258.html#e04fe83729dfd4a0c208511add1dc918" title="grid containes mapper, geometry, etc.">grid</a>-&gt;maxLevel() == <a class="code" href="a00255.html#52a4ae66e39cc96e4666ea4bb2d3ca1f" title="level of this element">level</a>() );
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541 
<a name="l00553"></a>00553   <span class="keyword">const</span> LocalGeometry&amp; geometryInFather () <span class="keyword">const</span>;
<a name="l00554"></a>00554 
<a name="l00561"></a>00561   <a class="code" href="a00140.html" title="Enables iteration over all codim zero entities in a subtree See also the documentation...">HierarchicIterator</a> hbegin (<span class="keywordtype">int</span> maxLevel) <span class="keyword">const</span>;
<a name="l00562"></a>00562 
<a name="l00564"></a>00564   <a class="code" href="a00140.html" title="Enables iteration over all codim zero entities in a subtree See also the documentation...">HierarchicIterator</a> hend (<span class="keywordtype">int</span> maxLevel) <span class="keyword">const</span>;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="comment">// members specific to SEntity</span>
<a name="l00568"></a><a class="code" href="a00256.html#254edc467a2b2e49cd31f7b6e1aee4a7">00568</a> <span class="comment"></span>  <a class="code" href="a00255.html#94a75c0ee4a775614cdbbb57e3b109d9" title="constructor">SEntity</a> (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) : 
<a name="l00569"></a>00569     <a class="code" href="a00258.html">SEntityBase</a>&lt;0,dim,GridImp&gt;::<a class="code" href="a00258.html">SEntityBase</a>(_grid,_l,_id)
<a name="l00570"></a>00570     {
<a name="l00571"></a>00571       built_father = <span class="keyword">false</span>;
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574   <a class="code" href="a00255.html#94a75c0ee4a775614cdbbb57e3b109d9" title="constructor">SEntity</a> ()
<a name="l00575"></a>00575     {
<a name="l00576"></a>00576       built_father = <span class="keyword">false</span>;
<a name="l00577"></a>00577     }
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   <span class="keywordtype">void</span> make (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id)
<a name="l00580"></a>00580     {
<a name="l00581"></a>00581       SEntityBase&lt;0,dim,GridImp&gt;::make(_grid,_l,_id);
<a name="l00582"></a>00582       built_father = <span class="keyword">false</span>;
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584 
<a name="l00586"></a><a class="code" href="a00256.html#c21e46ab11905457351968b6cd0de955">00586</a>   <span class="keywordtype">void</span> make (<span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id)
<a name="l00587"></a>00587     {
<a name="l00588"></a>00588       <a class="code" href="a00258.html">SEntityBase&lt;0,dim,GridImp&gt;::make</a>(_l,_id);
<a name="l00589"></a>00589       built_father = <span class="keyword">false</span>;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591   
<a name="l00592"></a>00592 <span class="keyword">private</span>:
<a name="l00593"></a>00593 
<a name="l00594"></a>00594   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> built_father;
<a name="l00595"></a>00595   <span class="keyword">mutable</span> <span class="keywordtype">int</span> father_id;
<a name="l00596"></a>00596     <span class="keyword">mutable</span> SMakeableGeometry&lt;dim,dim,const GridImp&gt; in_father_local;
<a name="l00597"></a>00597   <span class="keywordtype">void</span> make_father() <span class="keyword">const</span>;
<a name="l00598"></a>00598 };
<a name="l00599"></a>00599 
<a name="l00609"></a>00609 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00610"></a><a class="code" href="a00257.html">00610</a> <span class="keyword">class </span><a class="code" href="a00255.html">SEntity</a>&lt;dim,dim,GridImp&gt; : <span class="keyword">public</span> <a class="code" href="a00258.html">SEntityBase</a>&lt;dim,dim,GridImp&gt;, 
<a name="l00611"></a>00611                                  <span class="keyword">public</span> <a class="code" href="a00085.html" title="Default Implementations for EntityImp.">EntityDefaultImplementation</a> &lt;dim,dim,GridImp,SEntity&gt;
<a name="l00612"></a>00612 {
<a name="l00613"></a>00613   <span class="keyword">enum</span> { dimworld = GridImp::dimensionworld };
<a name="l00614"></a>00614 <span class="keyword">public</span>:
<a name="l00615"></a>00615   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;dim&gt;::Geometry <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>;
<a name="l00616"></a>00616   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::EntityPointer <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a>;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="comment">// disambiguate member functions with the same name in both bases</span>
<a name="l00620"></a><a class="code" href="a00257.html#927af3e7e2789b5602eb0302bc55d686">00620</a> <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="a00255.html#52a4ae66e39cc96e4666ea4bb2d3ca1f" title="level of this element">level</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;dim,dim,GridImp&gt;::level</a>();}
<a name="l00621"></a>00621 
<a name="l00623"></a><a class="code" href="a00257.html#27569475b352ed650405dfad0e0c004d">00623</a>   <span class="keywordtype">int</span> <a class="code" href="a00255.html#c5139347864b9768e5e3cd62abc53553" title="index is unique and consecutive per level and codim used for access to degrees of...">index</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;dim,dim,GridImp&gt;::index</a>();}
<a name="l00624"></a>00624   
<a name="l00626"></a><a class="code" href="a00257.html#4fffc436cebff271bf82661edc497a66">00626</a>   <a class="code" href="a00492.html#gbd89b77709db1d9e56bb17cd0aa44c3d" title="Attributes used in the generic overlap model.">PartitionType</a> <a class="code" href="a00255.html#9df1ca16ac8e26f907238e62d1a1a482" title="only interior entities">partitionType</a> ()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="a00492.html#ggbd89b77709db1d9e56bb17cd0aa44c3d1cdad324759fb0e56c7f035d91f7e4b8" title="all interior entities">InteriorEntity</a>; }
<a name="l00627"></a>00627 
<a name="l00629"></a><a class="code" href="a00257.html#2814502864af585c4220259043f9f547">00629</a>   <span class="keyword">const</span> <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>&amp; <a class="code" href="a00255.html#bbf9d0372ca40afa1713043cd01eb7ce" title="geometry of this entity">geometry</a> ()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="a00258.html">SEntityBase&lt;dim,dim,GridImp&gt;::geometry</a>();}
<a name="l00630"></a>00630 
<a name="l00631"></a>00631         <span class="comment">// members specific to SEntity</span>
<a name="l00633"></a><a class="code" href="a00257.html#e3a0b01903dc5dd88c8c0202ca4d2b19">00633</a> <span class="comment"></span>        <a class="code" href="a00255.html#94a75c0ee4a775614cdbbb57e3b109d9" title="constructor">SEntity</a> (GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) : <a class="code" href="a00258.html">SEntityBase</a>&lt;dim,dim,GridImp&gt;::<a class="code" href="a00258.html">SEntityBase</a>(_grid,_l,_id)
<a name="l00634"></a>00634         {
<a name="l00635"></a>00635                 built_father = <span class="keyword">false</span>;
<a name="l00636"></a>00636         }
<a name="l00637"></a>00637 
<a name="l00639"></a><a class="code" href="a00257.html#628d965b8180b1a1e5e7c17b016a3c48">00639</a>         <span class="keywordtype">void</span> make (<span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id)
<a name="l00640"></a>00640         {
<a name="l00641"></a>00641                 <a class="code" href="a00258.html">SEntityBase&lt;dim,dim,GridImp&gt;::make</a>(_l,_id);
<a name="l00642"></a>00642                 built_father = <span class="keyword">false</span>;
<a name="l00643"></a>00643         }
<a name="l00644"></a>00644 
<a name="l00645"></a>00645 <span class="keyword">private</span>:
<a name="l00646"></a>00646   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> built_father;
<a name="l00647"></a>00647   <span class="keyword">mutable</span> <span class="keywordtype">int</span> father_id;
<a name="l00648"></a>00648   <span class="keyword">mutable</span> FieldVector&lt;sgrid_ctype, dim&gt; in_father_local;
<a name="l00649"></a>00649   <span class="keywordtype">void</span> make_father() <span class="keyword">const</span>;
<a name="l00650"></a>00650 };
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keywordtype">int</span> dim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00653"></a>00653 <span class="keyword">class </span>SMakeableEntity :
<a name="l00654"></a>00654   <span class="keyword">public</span> GridImp::template Codim&lt;codim&gt;::Entity
<a name="l00655"></a>00655 {
<a name="l00656"></a>00656 <span class="keyword">public</span>:
<a name="l00657"></a>00657 
<a name="l00658"></a>00658   SMakeableEntity(GridImp* _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) :
<a name="l00659"></a>00659     GridImp::template Codim&lt;codim&gt;::Entity (SEntity&lt;codim, dim, GridImp&gt;(_grid,_l,_id))
<a name="l00660"></a>00660     {};
<a name="l00661"></a>00661   SMakeableEntity(<span class="keyword">const</span> SEntity&lt;codim, dim, GridImp&gt;&amp; e) :
<a name="l00662"></a>00662     GridImp::template Codim&lt;codim&gt;::Entity (e)
<a name="l00663"></a>00663     {};
<a name="l00664"></a>00664   <span class="keywordtype">void</span> make (<span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) { this-&gt;realEntity.make(_l, _id); }
<a name="l00665"></a>00665 };
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 <span class="comment">//************************************************************************</span>
<a name="l00675"></a><a class="code" href="a00267.html">00675</a> <span class="comment"></span><span class="keyword">struct </span><a class="code" href="a00267.html">SHierarchicStackElem</a> {
<a name="l00676"></a>00676   <span class="keywordtype">int</span> l;
<a name="l00677"></a>00677   <span class="keywordtype">int</span> id;
<a name="l00678"></a>00678   <a class="code" href="a00267.html">SHierarchicStackElem</a> () : l(-1), id(-1) {}
<a name="l00679"></a>00679   <a class="code" href="a00267.html">SHierarchicStackElem</a> (<span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) {l=_l; <span class="keywordtype">id</span>=_id;}
<a name="l00680"></a>00680   <span class="keywordtype">bool</span> operator== (<span class="keyword">const</span> <a class="code" href="a00267.html">SHierarchicStackElem</a>&amp; s)<span class="keyword"> const </span>{<span class="keywordflow">return</span> !operator!=(s);}
<a name="l00681"></a>00681   <span class="keywordtype">bool</span> operator!= (<span class="keyword">const</span> <a class="code" href="a00267.html">SHierarchicStackElem</a>&amp; s)<span class="keyword"> const </span>{<span class="keywordflow">return</span> l!=s.<a class="code" href="a00267.html#658992a68af9750323557d17e5831b7e">l</a> || <span class="keywordtype">id</span>!=s.<a class="code" href="a00267.html#97d1ac665db69abd3339c8dc3285c170">id</a>;}
<a name="l00682"></a>00682 };
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00685"></a>00685 <span class="keyword">class </span>SHierarchicIterator :
<a name="l00686"></a>00686   <span class="keyword">public</span> Dune::<a class="code" href="a00259.html">SEntityPointer</a> &lt;0,GridImp&gt;,
<a name="l00687"></a>00687   <span class="keyword">public</span> <a class="code" href="a00141.html" title="Default Implementations for HierarchicIteratorImp.">HierarchicIteratorDefaultImplementation</a> &lt;GridImp,SHierarchicIterator&gt;
<a name="l00688"></a>00688 {
<a name="l00689"></a>00689   <span class="keyword">friend</span> <span class="keyword">class </span>SHierarchicIterator&lt;const GridImp&gt;;
<a name="l00690"></a>00690   <span class="keyword">enum</span> { dim = GridImp::dimension };
<a name="l00691"></a>00691   <span class="keyword">enum</span> { dimworld = GridImp::dimensionworld };
<a name="l00692"></a>00692 <span class="keyword">public</span>:
<a name="l00693"></a>00693   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::Entity Entity;
<a name="l00694"></a>00694   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::ctype ctype;
<a name="l00695"></a>00695 
<a name="l00697"></a>00697   <span class="keywordtype">void</span> increment();
<a name="l00698"></a>00698 
<a name="l00705"></a>00705   SHierarchicIterator (GridImp* _grid,
<a name="l00706"></a>00706                        <span class="keyword">const</span> <a class="code" href="a00255.html">Dune::SEntity&lt;0,GridImp::dimension,GridImp&gt;</a>&amp; _e,
<a name="l00707"></a>00707                        <span class="keywordtype">int</span> _maxLevel, <span class="keywordtype">bool</span> makeend) :
<a name="l00708"></a>00708     Dune::<a class="code" href="a00259.html#43b7dd34d12d20001460ba90786bdf21" title="constructor">SEntityPointer</a>&lt;0,GridImp&gt;(_grid,_e.<a class="code" href="a00259.html#a3acb9c978cec49e7a583f472d35b7bf" title="ask for level of entity">level</a>(),_e.index())
<a name="l00709"></a>00709     {
<a name="l00710"></a>00710       <span class="comment">// without sons, we are done</span>
<a name="l00711"></a>00711       <span class="comment">// (the end iterator is equal to the calling iterator)</span>
<a name="l00712"></a>00712       <span class="keywordflow">if</span> (makeend) <span class="keywordflow">return</span>;
<a name="l00713"></a>00713       
<a name="l00714"></a>00714       <span class="comment">// remember element where begin has been called</span>
<a name="l00715"></a>00715       orig_l = this-&gt;<a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b" title="virtual entity">e</a>.level();
<a name="l00716"></a>00716       orig_id = _grid-&gt;template getRealEntity&lt;0&gt;(this-&gt;<a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b" title="virtual entity">e</a>).index();
<a name="l00717"></a>00717       
<a name="l00718"></a>00718       <span class="comment">// push original element on stack</span>
<a name="l00719"></a>00719       SHierarchicStackElem originalElement(orig_l, orig_id);
<a name="l00720"></a>00720       stack.push(originalElement);
<a name="l00721"></a>00721       
<a name="l00722"></a>00722       <span class="comment">// compute maxLevel</span>
<a name="l00723"></a>00723       maxLevel = std::min(_maxLevel,this-&gt;<a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446" title="my grid">grid</a>-&gt;maxLevel());
<a name="l00724"></a>00724       
<a name="l00725"></a>00725       <span class="comment">// ok, push all the sons as well</span>
<a name="l00726"></a>00726       push_sons(orig_l,orig_id);
<a name="l00727"></a>00727       
<a name="l00728"></a>00728       <span class="comment">// and pop the first son</span>
<a name="l00729"></a>00729       increment();
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="keyword">private</span>:
<a name="l00733"></a>00733   <span class="keywordtype">int</span> maxLevel;                
<a name="l00734"></a>00734   <span class="keywordtype">int</span> orig_l, orig_id;         
<a name="l00735"></a>00735 
<a name="l00736"></a>00736   FiniteStack&lt;SHierarchicStackElem,GridImp::MAXL&gt; stack;      
<a name="l00737"></a>00737   
<a name="l00738"></a>00738   <span class="keywordtype">void</span> push_sons (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> fatherid); 
<a name="l00739"></a>00739 };
<a name="l00740"></a>00740 
<a name="l00741"></a>00741 <span class="comment">//************************************************************************</span>
<a name="l00748"></a>00748 <span class="comment"></span><span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00749"></a><a class="code" href="a00273.html">00749</a> <span class="keyword">class </span><a class="code" href="a00273.html">SIntersectionIterator</a> :
<a name="l00750"></a>00750   <span class="keyword">public</span> <a class="code" href="a00155.html" title="Default Implementations for IntersectionIteratorImp.">IntersectionIteratorDefaultImplementation</a> &lt;GridImp,SIntersectionIterator&gt;
<a name="l00751"></a>00751 {
<a name="l00752"></a>00752   <span class="keyword">enum</span> { dim=GridImp::dimension };
<a name="l00753"></a>00753   <span class="keyword">enum</span> { dimworld=GridImp::dimensionworld };
<a name="l00754"></a>00754 <span class="keyword">public</span>:
<a name="l00755"></a>00755   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::Entity <a class="code" href="a00082.html" title="Wrapper class for entities.">Entity</a>;
<a name="l00756"></a>00756   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;0&gt;::EntityPointer <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a>;
<a name="l00757"></a>00757   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;1&gt;::Geometry <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>;
<a name="l00758"></a>00758   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;1&gt;::LocalGeometry LocalGeometry;
<a name="l00760"></a>00760   <span class="keyword">enum</span> { dimension=dim };
<a name="l00762"></a>00762   <span class="keyword">enum</span> { dimensionworld=dimworld };
<a name="l00764"></a><a class="code" href="a00273.html#d309e77b40bdc02987a89d18f2e1e046">00764</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::ctype <a class="code" href="a00273.html#d309e77b40bdc02987a89d18f2e1e046" title="define type used for coordinates in grid module">ctype</a>;
<a name="l00765"></a>00765 
<a name="l00767"></a>00767   <span class="keywordtype">bool</span> <a class="code" href="a00273.html#30ac82806cfe931690ed3cf0d27f99f4" title="equality">equals</a>(<span class="keyword">const</span> <a class="code" href="a00273.html">SIntersectionIterator&lt;GridImp&gt;</a>&amp; i) <span class="keyword">const</span>;
<a name="l00769"></a>00769   <span class="keywordtype">void</span> <a class="code" href="a00273.html#1ef3c7035d7ed82933822c5be369d8a1" title="increment">increment</a>();
<a name="l00770"></a>00770 
<a name="l00773"></a>00773   <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a> <a class="code" href="a00273.html#5d085aefb01a016f9a24358f7bca2e8a">inside</a>() <span class="keyword">const</span>;
<a name="l00774"></a>00774 
<a name="l00777"></a>00777   <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a> <a class="code" href="a00273.html#18ce99dfed046799cf2a00cde13ecf7d">outside</a>() <span class="keyword">const</span>;
<a name="l00778"></a>00778   
<a name="l00780"></a>00780   <span class="keywordtype">bool</span> <a class="code" href="a00273.html#025112ae09f2f2a519cb6efceb28ad54" title="return true if intersection is with boundary.">boundary</a> () <span class="keyword">const</span>;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782   <span class="keywordtype">int</span> boundaryId ()<span class="keyword"> const </span>{
<a name="l00783"></a>00783     <span class="keywordflow">if</span> (<a class="code" href="a00273.html#025112ae09f2f2a519cb6efceb28ad54" title="return true if intersection is with boundary.">boundary</a>()) <span class="keywordflow">return</span> count + 1;
<a name="l00784"></a>00784     <span class="keywordflow">return</span> 0;
<a name="l00785"></a>00785   };
<a name="l00787"></a>00787   <span class="keywordtype">bool</span> <a class="code" href="a00273.html#d3e1381f390a96089a33fca0cf799ef5" title="return true if neighbor on this level exists">neighbor</a> () <span class="keyword">const</span>;
<a name="l00788"></a>00788 
<a name="l00790"></a><a class="code" href="a00273.html#5aeaa7215c48f943b5891a0bcf8dce36">00790</a>   FieldVector&lt;ctype, GridImp::dimensionworld&gt; <a class="code" href="a00273.html#5aeaa7215c48f943b5891a0bcf8dce36" title="return outer normal">outerNormal</a> (<span class="keyword">const</span> FieldVector&lt;ctype, GridImp::dimension-1&gt;&amp; local)<span class="keyword"> const</span>
<a name="l00791"></a>00791 <span class="keyword">    </span>{
<a name="l00792"></a>00792       <span class="keywordflow">return</span> <a class="code" href="a00273.html#1a6307c0b73d941fe6e5aaa4374bb4d1" title="return unit outer normal">unitOuterNormal</a>(local);
<a name="l00793"></a>00793     }
<a name="l00795"></a><a class="code" href="a00273.html#1a6307c0b73d941fe6e5aaa4374bb4d1">00795</a>   FieldVector&lt;ctype, GridImp::dimensionworld&gt; <a class="code" href="a00273.html#1a6307c0b73d941fe6e5aaa4374bb4d1" title="return unit outer normal">unitOuterNormal</a> (<span class="keyword">const</span> FieldVector&lt;ctype, GridImp::dimension-1&gt;&amp; local)<span class="keyword"> const</span>
<a name="l00796"></a>00796 <span class="keyword">    </span>{
<a name="l00797"></a>00797       <span class="comment">// while we are at it, compute normal direction</span>
<a name="l00798"></a>00798       FieldVector&lt;sgrid_ctype, dimworld&gt; normal(0.0);
<a name="l00799"></a>00799       <span class="keywordflow">if</span> (count%2)
<a name="l00800"></a>00800         normal[count/2] =  1.0; <span class="comment">// odd</span>
<a name="l00801"></a>00801       <span class="keywordflow">else</span>
<a name="l00802"></a>00802         normal[count/2] = -1.0; <span class="comment">// even</span>
<a name="l00803"></a>00803       
<a name="l00804"></a>00804       <span class="keywordflow">return</span> normal; 
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806 
<a name="l00810"></a>00810   LocalGeometry&amp; <a class="code" href="a00273.html#84b086eeca50bfc1e379dd8debe8b4c4">intersectionSelfLocal</a> () <span class="keyword">const</span>;
<a name="l00814"></a>00814   LocalGeometry&amp; <a class="code" href="a00273.html#355ab45ecf0af27f90a840ea0a72ce30">intersectionNeighborLocal</a> () <span class="keyword">const</span>;
<a name="l00818"></a>00818   <a class="code" href="a00094.html" title="Wrapper class for geometries.">Geometry</a>&amp; <a class="code" href="a00273.html#ca2d44c9e39dad84502e59a8231ecc89">intersectionGlobal</a> () <span class="keyword">const</span>;
<a name="l00820"></a>00820   <span class="keywordtype">int</span> <a class="code" href="a00273.html#9ed5a565bc407867ab5261f164d43db8" title="local number of codim 1 entity in self where intersection is contained in">numberInSelf</a> () <span class="keyword">const</span>;
<a name="l00822"></a>00822   <span class="keywordtype">int</span> <a class="code" href="a00273.html#a8b78e2bf9fb151e3771da0aa05bc4b2" title="local number of codim 1 entity in neighbor where intersection is contained in">numberInNeighbor</a> () <span class="keyword">const</span>;
<a name="l00823"></a>00823 
<a name="l00825"></a>00825   <a class="code" href="a00273.html#82f774c9948d076f49eaa274ba7d7828" title="constructor">SIntersectionIterator</a> (GridImp* _grid, <span class="keyword">const</span> <a class="code" href="a00255.html">SEntity&lt;0,dim,GridImp &gt;</a>* _self, <span class="keywordtype">int</span> _count);
<a name="l00826"></a>00826 
<a name="l00828"></a><a class="code" href="a00273.html#f33c36179fd0fd3466be91a306cdf4f5">00828</a>   <a class="code" href="a00273.html">SIntersectionIterator</a>&amp; <a class="code" href="a00273.html#f33c36179fd0fd3466be91a306cdf4f5" title="assignment operator">operator = </a>(<span class="keyword">const</span> <a class="code" href="a00273.html">SIntersectionIterator</a>&amp; it)
<a name="l00829"></a>00829     {
<a name="l00830"></a>00830       assert(grid == it.<a class="code" href="a00273.html#63eb984bf1edd58fea50bfaa380f576d" title="Pointer to the grid.">grid</a>);
<a name="l00831"></a>00831       
<a name="l00832"></a>00832       <span class="comment">/* Assert same Iterator Context */</span>
<a name="l00833"></a>00833       <span class="keywordflow">if</span> (! <span class="keyword">self</span>.<a class="code" href="a00273.html#30ac82806cfe931690ed3cf0d27f99f4" title="equality">equals</a>(it.<a class="code" href="a00273.html#92d35bd6a64281fc32cc78ad2b736641" title="EntityPointer for myself.">self</a>))
<a name="l00834"></a>00834         DUNE_THROW(<a class="code" href="a00105.html" title="Base class for exceptions in Dune grid modules.">GridError</a>, <span class="stringliteral">"assignment of SIntersectionIterator "</span>
<a name="l00835"></a>00835                    &lt;&lt; <span class="stringliteral">"with different inside Entity"</span>);
<a name="l00836"></a>00836       <span class="keywordflow">if</span> (partition != it.<a class="code" href="a00273.html#111b04a755678eaa5afbfe46f43b1908" title="partition number of self, needed for coordinate expansion">partition</a>)
<a name="l00837"></a>00837         DUNE_THROW(<a class="code" href="a00105.html" title="Base class for exceptions in Dune grid modules.">GridError</a>, <span class="stringliteral">"assignment of SIntersectionIterator "</span>
<a name="l00838"></a>00838                    &lt;&lt; <span class="stringliteral">"with different partition"</span>);
<a name="l00839"></a>00839       <span class="comment">// (zred == it.zred) if (self == it.self)</span>
<a name="l00840"></a>00840 
<a name="l00841"></a>00841       <span class="comment">/* Assign current position and update ne */</span>
<a name="l00842"></a>00842       ne = it.<a class="code" href="a00273.html#d8c51d4735e72d10624a9d25c43013a9" title="EntityPointer for neighbor.">ne</a>;
<a name="l00843"></a>00843       count = it.<a class="code" href="a00273.html#999af4467528a35172fd9d637332df8e" title="number of neighbor">count</a>;
<a name="l00844"></a>00844       make(count);
<a name="l00845"></a>00845 
<a name="l00846"></a>00846       <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00847"></a>00847     }
<a name="l00848"></a>00848   
<a name="l00849"></a>00849 <span class="keyword">private</span>:
<a name="l00850"></a>00850   <span class="keywordtype">void</span> make (<span class="keywordtype">int</span> _count) <span class="keyword">const</span>;                 
<a name="l00851"></a>00851   <span class="keywordtype">void</span> makeintersections () <span class="keyword">const</span>;              
<a name="l00852"></a>00852   <span class="keyword">const</span> <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a> <span class="keyword">self</span>;                     
<a name="l00853"></a>00853   <span class="keyword">mutable</span> <a class="code" href="a00087.html" title="Wrapper class for pointers to entities.">EntityPointer</a> ne;                     
<a name="l00854"></a>00854   <span class="keyword">const</span> GridImp * grid;                         
<a name="l00855"></a>00855   <span class="keyword">const</span> <span class="keywordtype">int</span> partition;                          
<a name="l00856"></a>00856   <span class="keyword">const</span> array&lt;int,dim&gt; zred;                 
<a name="l00857"></a>00857   <span class="keyword">mutable</span> <span class="keywordtype">int</span> count;                              
<a name="l00858"></a>00858   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> valid_count;                       
<a name="l00859"></a>00859   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> valid_nb;                          
<a name="l00860"></a>00860   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> is_on_boundary;                    
<a name="l00861"></a>00861   <span class="keyword">mutable</span> <span class="keywordtype">bool</span> built_intersections;               
<a name="l00862"></a>00862   <span class="keyword">mutable</span> SMakeableGeometry&lt;dim-1,dim,<span class="keyword">const</span> GridImp&gt; is_self_local;      
<a name="l00863"></a>00863   <span class="keyword">mutable</span> SMakeableGeometry&lt;dim-1,dimworld,<span class="keyword">const</span> GridImp&gt; is_global;     
<a name="l00864"></a>00864   <span class="keyword">mutable</span> SMakeableGeometry&lt;dim-1,dim,<span class="keyword">const</span> GridImp&gt; is_nb_local;        
<a name="l00865"></a>00865 };
<a name="l00866"></a>00866 
<a name="l00867"></a>00867 <span class="comment">//************************************************************************</span>
<a name="l00868"></a>00868 
<a name="l00871"></a>00871 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00872"></a><a class="code" href="a00259.html">00872</a> <span class="keyword">class </span><a class="code" href="a00259.html">SEntityPointer</a> :
<a name="l00873"></a>00873   <span class="keyword">public</span> <a class="code" href="a00088.html" title="Default implementation of EntityPointer.">EntityPointerDefaultImplementation</a> &lt;codim, GridImp,
<a name="l00874"></a>00874                                Dune::SEntityPointer&lt;codim,GridImp&gt; &gt;
<a name="l00875"></a>00875 {
<a name="l00876"></a>00876   <span class="keyword">enum</span> { dim = GridImp::dimension };
<a name="l00877"></a>00877   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00273.html">SIntersectionIterator</a>&lt;GridImp&gt;;
<a name="l00878"></a>00878 <span class="keyword">public</span>:
<a name="l00879"></a>00879   <span class="keyword">typedef</span> <a class="code" href="a00259.html">SEntityPointer&lt;codim,GridImp&gt;</a> <a class="code" href="a00259.html">Base</a>;
<a name="l00880"></a>00880   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;codim&gt;::Entity <a class="code" href="a00082.html" title="Wrapper class for entities.">Entity</a>;
<a name="l00881"></a>00881 
<a name="l00883"></a>00883   <span class="keywordtype">bool</span> <a class="code" href="a00259.html#e8b0a9a19b4291ae99cee023a75b9b36" title="equality">equals</a>(<span class="keyword">const</span> <a class="code" href="a00259.html">SEntityPointer&lt;codim,GridImp&gt;</a>&amp; i) <span class="keyword">const</span>;
<a name="l00885"></a>00885   <a class="code" href="a00082.html" title="Wrapper class for entities.">Entity</a>&amp; <a class="code" href="a00259.html#a92255bc0010465c05a28b8f98f13706" title="dereferencing">dereference</a>() <span class="keyword">const</span>;
<a name="l00887"></a>00887   <span class="keywordtype">int</span> <a class="code" href="a00259.html#a3acb9c978cec49e7a583f472d35b7bf" title="ask for level of entity">level</a> () <span class="keyword">const</span>;
<a name="l00888"></a>00888 
<a name="l00890"></a><a class="code" href="a00259.html#43b7dd34d12d20001460ba90786bdf21">00890</a>   <a class="code" href="a00259.html#43b7dd34d12d20001460ba90786bdf21" title="constructor">SEntityPointer</a> (GridImp * _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) :
<a name="l00891"></a>00891     <a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446" title="my grid">grid</a>(_grid), <a class="code" href="a00259.html#72340a0419ef503bc6a19d01c75348da" title="level where element is on">l</a>(_l), <a class="code" href="a00259.html#7414ee25d9527811a0999adb1c8365b6" title="my consecutive id">id</a>(_id), <a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b" title="virtual entity">e</a>(_grid,_l,_id) { }
<a name="l00892"></a>00892   
<a name="l00894"></a><a class="code" href="a00259.html#97824afcfc7ede9f281d9b6f4527f4f2">00894</a>   <a class="code" href="a00259.html#43b7dd34d12d20001460ba90786bdf21" title="constructor">SEntityPointer</a> (<span class="keyword">const</span> <a class="code" href="a00255.html">SEntity&lt;codim,dim,GridImp&gt;</a> &amp; _e) :
<a name="l00895"></a>00895     <a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446" title="my grid">grid</a>(_e.<a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446" title="my grid">grid</a>), <a class="code" href="a00259.html#72340a0419ef503bc6a19d01c75348da" title="level where element is on">l</a>(_e.<a class="code" href="a00259.html#72340a0419ef503bc6a19d01c75348da" title="level where element is on">l</a>), <a class="code" href="a00259.html#7414ee25d9527811a0999adb1c8365b6" title="my consecutive id">id</a>(_e.<a class="code" href="a00259.html#7414ee25d9527811a0999adb1c8365b6" title="my consecutive id">id</a>), <a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b" title="virtual entity">e</a>(_e) { }
<a name="l00896"></a>00896   
<a name="l00897"></a>00897 <span class="keyword">protected</span>:
<a name="l00898"></a><a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446">00898</a>   GridImp* <a class="code" href="a00259.html#a7e14b3c3ea4910efddae6b2381d2446" title="my grid">grid</a>;                 
<a name="l00899"></a><a class="code" href="a00259.html#72340a0419ef503bc6a19d01c75348da">00899</a>   <span class="keywordtype">int</span> <a class="code" href="a00259.html#72340a0419ef503bc6a19d01c75348da" title="level where element is on">l</a>;                         
<a name="l00900"></a><a class="code" href="a00259.html#7414ee25d9527811a0999adb1c8365b6">00900</a>   <span class="keyword">mutable</span> <span class="keywordtype">int</span> <a class="code" href="a00259.html#7414ee25d9527811a0999adb1c8365b6" title="my consecutive id">id</a>;                
<a name="l00901"></a><a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b">00901</a>   <span class="keyword">mutable</span> SMakeableEntity&lt;codim,dim,GridImp&gt; <a class="code" href="a00259.html#daabc527bf3c81dc8a430a2cef348b5b" title="virtual entity">e</a>;  
<a name="l00902"></a>00902 };
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="comment">//************************************************************************</span>
<a name="l00905"></a>00905 
<a name="l00908"></a>00908 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim, PartitionIteratorType pitype, <span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00909"></a><a class="code" href="a00275.html">00909</a> <span class="keyword">class </span><a class="code" href="a00275.html">SLevelIterator</a> :
<a name="l00910"></a>00910   <span class="keyword">public</span> Dune::<a class="code" href="a00259.html">SEntityPointer</a> &lt;codim,GridImp&gt;,
<a name="l00911"></a>00911   <span class="keyword">public</span> <a class="code" href="a00207.html" title="Default Implementations for LevelIteratorImp.">LevelIteratorDefaultImplementation</a> &lt;codim,pitype,GridImp,SLevelIterator&gt;
<a name="l00912"></a>00912 {
<a name="l00913"></a>00913   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="a00275.html">SLevelIterator</a>&lt;codim, pitype,const GridImp&gt;;
<a name="l00914"></a>00914   <span class="keyword">enum</span> { dim = GridImp::dimension };
<a name="l00915"></a>00915 <span class="keyword">public</span>:
<a name="l00916"></a>00916   <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::template Codim&lt;codim&gt;::Entity <a class="code" href="a00082.html" title="Wrapper class for entities.">Entity</a>;
<a name="l00917"></a>00917 
<a name="l00919"></a>00919   <span class="keywordtype">void</span> <a class="code" href="a00275.html#8e8c30a1a85a7284a9fe0838c0b948e8" title="increment">increment</a>();
<a name="l00920"></a>00920 
<a name="l00922"></a><a class="code" href="a00275.html#08765ca535cab0d590f47bad9990f624">00922</a>   <a class="code" href="a00275.html#08765ca535cab0d590f47bad9990f624" title="constructor">SLevelIterator</a> (GridImp * _grid, <span class="keywordtype">int</span> _l, <span class="keywordtype">int</span> _id) :
<a name="l00923"></a>00923     Dune::<a class="code" href="a00259.html">SEntityPointer</a>&lt;codim,GridImp&gt;(_grid,_l,_id) {}
<a name="l00924"></a>00924 };
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 
<a name="l00927"></a>00927 <span class="comment">//========================================================================</span>
<a name="l00932"></a>00932 <span class="comment"></span><span class="comment">//========================================================================</span>
<a name="l00933"></a>00933 
<a name="l00934"></a>00934 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; 
<a name="l00935"></a><a class="code" href="a00265.html">00935</a> <span class="keyword">struct </span><a class="code" href="a00265.html" title="implementation of index set">SGridLevelIndexSetTypes</a>
<a name="l00936"></a>00936 {
<a name="l00938"></a>00938   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l00939"></a><a class="code" href="a00266.html">00939</a>   <span class="keyword">struct </span><a class="code" href="a00266.html" title="The types.">Codim</a>
<a name="l00940"></a>00940   {
<a name="l00941"></a>00941         <span class="keyword">template</span>&lt;PartitionIteratorType pitype&gt;
<a name="l00942"></a>00942         <span class="keyword">struct </span>Partition
<a name="l00943"></a>00943         {
<a name="l00944"></a>00944           <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::Traits::template <a class="code" href="a00266.html" title="The types.">Codim&lt;cd&gt;::template</a> Partition&lt;pitype&gt;::LevelIterator Iterator;
<a name="l00945"></a>00945         };
<a name="l00946"></a>00946   };
<a name="l00947"></a>00947 };
<a name="l00948"></a>00948 
<a name="l00949"></a>00949 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l00950"></a>00950 <span class="keyword">class </span>SGridLevelIndexSet : <span class="keyword">public</span> <a class="code" href="a00148.html" title="Provide default implementation of method if IndexSet.">IndexSetDefaultImplementation</a>&lt;GridImp,SGridLevelIndexSet&lt;GridImp&gt;,SGridLevelIndexSetTypes&lt;GridImp&gt; &gt;
<a name="l00951"></a>00951 {
<a name="l00952"></a>00952   <span class="keyword">typedef</span> <a class="code" href="a00148.html" title="Provide default implementation of method if IndexSet.">IndexSetDefaultImplementation&lt;GridImp,SGridLevelIndexSet&lt;GridImp&gt;</a>,<a class="code" href="a00265.html" title="implementation of index set">SGridLevelIndexSetTypes&lt;GridImp&gt;</a> &gt; Base;
<a name="l00953"></a>00953 <span class="keyword">public</span>:
<a name="l00954"></a>00954 
<a name="l00956"></a>00956   SGridLevelIndexSet (<span class="keyword">const</span> GridImp&amp; g, <span class="keywordtype">int</span> l) : grid(g), level(l)
<a name="l00957"></a>00957   {
<a name="l00958"></a>00958     <span class="comment">// contains a single element type;</span>
<a name="l00959"></a>00959         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> codim=0; codim&lt;=GridImp::dimension; codim++)
<a name="l00960"></a>00960           mytypes[codim].push_back(GeometryType(GeometryType::cube,GridImp::dimension-codim));
<a name="l00961"></a>00961   }
<a name="l00962"></a>00962 
<a name="l00964"></a>00964   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l00965"></a>00965   <span class="keywordtype">int</span> index (<span class="keyword">const</span> <span class="keyword">typename</span> GridImp::Traits::template Codim&lt;cd&gt;::Entity&amp; e)<span class="keyword"> const </span>
<a name="l00966"></a>00966 <span class="keyword">  </span>{
<a name="l00967"></a>00967         <span class="keywordflow">return</span> grid.template getRealEntity&lt;cd&gt;(e).compressedIndex(); 
<a name="l00968"></a>00968   }
<a name="l00969"></a>00969 
<a name="l00971"></a>00971   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l00972"></a>00972   <span class="keywordtype">int</span> <a class="code" href="a00148.html#7dfec044882a29ef13b6fb78ffc5a4a4" title="Return total number of entities of given codim as a sum for all geometry types in...">subIndex</a> (<span class="keyword">const</span> <span class="keyword">typename</span> GridImp::Traits::template Codim&lt;0&gt;::Entity&amp; e, <span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00973"></a>00973 <span class="keyword">  </span>{
<a name="l00974"></a>00974         <span class="keywordflow">return</span> grid.template getRealEntity&lt;0&gt;(e).<span class="keyword">template</span> subCompressedIndex&lt;cc&gt;(i);
<a name="l00975"></a>00975   }
<a name="l00976"></a>00976 
<a name="l00978"></a>00978   <span class="keywordtype">int</span> size (GeometryType type)<span class="keyword"> const</span>
<a name="l00979"></a>00979 <span class="keyword">  </span>{
<a name="l00980"></a>00980       <span class="keywordflow">return</span> grid.size(level,GridImp::dimension-type.dim());
<a name="l00981"></a>00981   }
<a name="l00982"></a>00982   
<a name="l00984"></a>00984   <span class="keywordtype">int</span> size (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l00985"></a>00985 <span class="keyword">  </span>{
<a name="l00986"></a>00986     <span class="keywordflow">return</span> <a class="code" href="a00148.html#ad4160829326bc6c0ad75cd829ea04c4" title="Return total number of entities of given codim in the entity set . This is simply...">Base::size</a>(codim);
<a name="l00987"></a>00987   }
<a name="l00988"></a>00988 
<a name="l00990"></a>00990   <span class="keyword">const</span> std::vector&lt;GeometryType&gt;&amp; geomTypes (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l00991"></a>00991 <span class="keyword">  </span>{
<a name="l00992"></a>00992         <span class="keywordflow">return</span> mytypes[codim];
<a name="l00993"></a>00993   }
<a name="l00994"></a>00994 
<a name="l00996"></a>00996   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l00997"></a>00997   <span class="keyword">typename</span> Base::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::Iterator begin ()<span class="keyword"> const</span>
<a name="l00998"></a>00998 <span class="keyword">  </span>{
<a name="l00999"></a>00999         <span class="keywordflow">return</span> grid.template lbegin&lt;cd,pitype&gt;(level);
<a name="l01000"></a>01000   }
<a name="l01001"></a>01001   
<a name="l01003"></a>01003   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01004"></a>01004   <span class="keyword">typename</span> Base::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::Iterator end ()<span class="keyword"> const</span>
<a name="l01005"></a>01005 <span class="keyword">  </span>{
<a name="l01006"></a>01006         <span class="keywordflow">return</span> grid.template lend&lt;cd,pitype&gt;(level);
<a name="l01007"></a>01007   }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 <span class="keyword">private</span>:
<a name="l01010"></a>01010   <span class="keyword">const</span> GridImp&amp; grid;
<a name="l01011"></a>01011   <span class="keywordtype">int</span> level;
<a name="l01012"></a>01012   std::vector&lt;GeometryType&gt; mytypes[GridImp::dimension+1];
<a name="l01013"></a>01013 };
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 <span class="comment">// Leaf Index Set</span>
<a name="l01016"></a>01016 
<a name="l01017"></a>01017 <span class="keyword">template</span> &lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt; 
<a name="l01018"></a>01018 <span class="keyword">struct </span>SGridLeafIndexSetTypes
<a name="l01019"></a>01019 {
<a name="l01021"></a>01021   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01022"></a><a class="code" href="a00264.html">01022</a>   <span class="keyword">struct </span><a class="code" href="a00264.html" title="The types.">Codim</a>
<a name="l01023"></a>01023   {
<a name="l01024"></a>01024         <span class="keyword">template</span>&lt;PartitionIteratorType pitype&gt;
<a name="l01025"></a>01025         <span class="keyword">struct </span>Partition
<a name="l01026"></a>01026         {
<a name="l01027"></a>01027           <span class="keyword">typedef</span> <span class="keyword">typename</span> GridImp::Traits::template <a class="code" href="a00264.html" title="The types.">Codim&lt;cd&gt;::template</a> Partition&lt;pitype&gt;::LeafIterator Iterator;
<a name="l01028"></a>01028         };
<a name="l01029"></a>01029   };
<a name="l01030"></a>01030 };
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l01033"></a>01033 <span class="keyword">class </span>SGridLeafIndexSet : <span class="keyword">public</span> <a class="code" href="a00148.html" title="Provide default implementation of method if IndexSet.">IndexSetDefaultImplementation</a>&lt;GridImp,SGridLeafIndexSet&lt;GridImp&gt;,SGridLeafIndexSetTypes&lt;GridImp&gt; &gt;
<a name="l01034"></a>01034 {
<a name="l01035"></a>01035   <span class="keyword">typedef</span> <a class="code" href="a00148.html" title="Provide default implementation of method if IndexSet.">IndexSetDefaultImplementation&lt;GridImp,SGridLeafIndexSet&lt;GridImp&gt;</a>,SGridLeafIndexSetTypes&lt;GridImp&gt; &gt; Base;
<a name="l01036"></a>01036     <span class="keyword">enum</span> {dim = remove_const&lt;GridImp&gt;::type::dimension};
<a name="l01037"></a>01037 <span class="keyword">public</span>:
<a name="l01038"></a>01038 
<a name="l01040"></a>01040   SGridLeafIndexSet (<span class="keyword">const</span> GridImp&amp; g) : grid(g)
<a name="l01041"></a>01041   {
<a name="l01042"></a>01042     <span class="comment">// contains a single element type;</span>
<a name="l01043"></a>01043         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> codim=0; codim&lt;=dim; codim++)
<a name="l01044"></a>01044           mytypes[codim].push_back(GeometryType(GeometryType::cube,dim-codim));
<a name="l01045"></a>01045   }
<a name="l01046"></a>01046 
<a name="l01048"></a>01048   <span class="comment">/*</span>
<a name="l01049"></a>01049 <span class="comment">    We use the remove_const to extract the Type from the mutable class,</span>
<a name="l01050"></a>01050 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01051"></a>01051 <span class="comment">  */</span>
<a name="l01052"></a>01052   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01053"></a>01053   <span class="keywordtype">int</span> <a class="code" href="a00145.html#8ec792aaa5a02d0c78d1f2b1faf3eaf8" title="Map entity to index. The result of calling this method with an entity that is not...">index</a> (<span class="keyword">const</span> <span class="keyword">typename</span> remove_const&lt;GridImp&gt;::type::Traits::template Codim&lt;cd&gt;::Entity&amp; e)<span class="keyword"> const </span>
<a name="l01054"></a>01054 <span class="keyword">  </span>{
<a name="l01055"></a>01055         <span class="keywordflow">return</span> grid.template getRealEntity&lt;cd&gt;(e).compressedLeafIndex(); 
<a name="l01056"></a>01056   }
<a name="l01057"></a>01057 
<a name="l01059"></a>01059   <span class="comment">/*</span>
<a name="l01060"></a>01060 <span class="comment">    We use the remove_const to extract the Type from the mutable class,</span>
<a name="l01061"></a>01061 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01062"></a>01062 <span class="comment">  */</span>
<a name="l01063"></a>01063   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l01064"></a>01064   <span class="keywordtype">int</span> subIndex (<span class="keyword">const</span> <span class="keyword">typename</span> remove_const&lt;GridImp&gt;::type::Traits::template Codim&lt;0&gt;::Entity&amp; e, <span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l01065"></a>01065 <span class="keyword">  </span>{
<a name="l01066"></a>01066         <span class="keywordflow">return</span> grid.template getRealEntity&lt;0&gt;(e).<span class="keyword">template</span> subCompressedLeafIndex&lt;cc&gt;(i);
<a name="l01067"></a>01067   }
<a name="l01068"></a>01068 
<a name="l01070"></a>01070   <span class="keywordtype">int</span> size (GeometryType type)<span class="keyword"> const</span>
<a name="l01071"></a>01071 <span class="keyword">  </span>{
<a name="l01072"></a>01072       <span class="keywordflow">return</span> grid.size(grid.maxLevel(),GridImp::dimension-type.dim());
<a name="l01073"></a>01073   }
<a name="l01074"></a>01074 
<a name="l01076"></a>01076   <span class="keywordtype">int</span> size (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01077"></a>01077 <span class="keyword">  </span>{
<a name="l01078"></a>01078     <span class="keywordflow">return</span> <a class="code" href="a00148.html#ad4160829326bc6c0ad75cd829ea04c4" title="Return total number of entities of given codim in the entity set . This is simply...">Base::size</a>(codim);
<a name="l01079"></a>01079   }
<a name="l01080"></a>01080 
<a name="l01082"></a>01082   <span class="keyword">const</span> std::vector&lt;GeometryType&gt;&amp; geomTypes (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01083"></a>01083 <span class="keyword">  </span>{
<a name="l01084"></a>01084         <span class="keywordflow">return</span> mytypes[codim];
<a name="l01085"></a>01085   }
<a name="l01086"></a>01086 
<a name="l01088"></a>01088   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01089"></a>01089   <span class="keyword">typename</span> Base::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::Iterator begin ()<span class="keyword"> const</span>
<a name="l01090"></a>01090 <span class="keyword">  </span>{
<a name="l01091"></a>01091         <span class="keywordflow">return</span> grid.template leafbegin&lt;cd,pitype&gt;();
<a name="l01092"></a>01092   }
<a name="l01093"></a>01093   
<a name="l01095"></a>01095   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01096"></a>01096   <span class="keyword">typename</span> Base::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::Iterator end ()<span class="keyword"> const</span>
<a name="l01097"></a>01097 <span class="keyword">  </span>{
<a name="l01098"></a>01098         <span class="keywordflow">return</span> grid.template leafend&lt;cd,pitype&gt;();
<a name="l01099"></a>01099   }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101 <span class="keyword">private</span>:
<a name="l01102"></a>01102   <span class="keyword">const</span> GridImp&amp; grid;
<a name="l01103"></a>01103   std::vector&lt;GeometryType&gt; mytypes[dim+1];
<a name="l01104"></a>01104 };
<a name="l01105"></a>01105 
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 <span class="comment">//========================================================================</span>
<a name="l01112"></a>01112 <span class="comment"></span><span class="comment">//========================================================================</span>
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 <span class="keyword">template</span>&lt;<span class="keyword">class</span> Gr<span class="keywordtype">id</span>Imp&gt;
<a name="l01115"></a><a class="code" href="a00263.html">01115</a> <span class="keyword">class </span><a class="code" href="a00263.html" title="persistent, globally unique Ids">SGridGlobalIdSet</a> :
<a name="l01116"></a>01116   <span class="keyword">public</span> <a class="code" href="a00144.html" title="Id Set DefaultImplementation.">IdSetDefaultImplementation</a>&lt;GridImp,SGridGlobalIdSet&lt;GridImp&gt;, typename remove_const&lt;GridImp&gt;::type::PersistentIndexType&gt;
<a name="l01117"></a>01117   <span class="comment">/*</span>
<a name="l01118"></a>01118 <span class="comment">    We used the remove_const to extract the Type from the mutable class,</span>
<a name="l01119"></a>01119 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01120"></a>01120 <span class="comment">  */</span>
<a name="l01121"></a>01121 {
<a name="l01122"></a>01122 <span class="keyword">public</span>:
<a name="l01124"></a>01124   <span class="comment">/*</span>
<a name="l01125"></a>01125 <span class="comment">    We use the remove_const to extract the Type from the mutable class,</span>
<a name="l01126"></a>01126 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01127"></a>01127 <span class="comment">  */</span>
<a name="l01128"></a><a class="code" href="a00263.html#de94312ad86d828f3d4ab27e03ca6df2">01128</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> remove_const&lt;GridImp&gt;::type::PersistentIndexType <a class="code" href="a00263.html#de94312ad86d828f3d4ab27e03ca6df2" title="define the type used for persisitent indices">IdType</a>;
<a name="l01129"></a>01129 
<a name="l01131"></a><a class="code" href="a00263.html#a720d20c04118f195f01da00664c6c36">01131</a>   <a class="code" href="a00263.html#a720d20c04118f195f01da00664c6c36" title="constructor stores reference to a grid">SGridGlobalIdSet</a> (<span class="keyword">const</span> GridImp&amp; g) : grid(g) {}
<a name="l01132"></a>01132 
<a name="l01134"></a>01134   <span class="comment">/*</span>
<a name="l01135"></a>01135 <span class="comment">    We use the remove_const to extract the Type from the mutable class,</span>
<a name="l01136"></a>01136 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01137"></a>01137 <span class="comment">  */</span>
<a name="l01138"></a>01138   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01139"></a><a class="code" href="a00263.html#376ed277e2200af82930f94a95885bf7">01139</a>   <a class="code" href="a00263.html#de94312ad86d828f3d4ab27e03ca6df2" title="define the type used for persisitent indices">IdType</a> <a class="code" href="a00263.html#376ed277e2200af82930f94a95885bf7" title="get id of an entity">id</a> (<span class="keyword">const</span> <span class="keyword">typename</span> remove_const&lt;GridImp&gt;::type::Traits::template Codim&lt;cd&gt;::Entity&amp; e)<span class="keyword"> const </span>
<a name="l01140"></a>01140 <span class="keyword">  </span>{
<a name="l01141"></a>01141           <span class="keywordflow">return</span> grid.template getRealEntity&lt;cd&gt;(e).persistentIndex();
<a name="l01142"></a>01142   }
<a name="l01143"></a>01143 
<a name="l01145"></a>01145   <span class="comment">/*</span>
<a name="l01146"></a>01146 <span class="comment">    We use the remove_const to extract the Type from the mutable class,</span>
<a name="l01147"></a>01147 <span class="comment">    because the const class is not instantiated yet.</span>
<a name="l01148"></a>01148 <span class="comment">  */</span>
<a name="l01149"></a>01149   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cc&gt;
<a name="l01150"></a><a class="code" href="a00263.html#35e7ed48103cee1eda45dafaa711c161">01150</a>   <a class="code" href="a00263.html#de94312ad86d828f3d4ab27e03ca6df2" title="define the type used for persisitent indices">IdType</a> <a class="code" href="a00263.html#35e7ed48103cee1eda45dafaa711c161" title="get id of subentity">subId</a> (<span class="keyword">const</span> <span class="keyword">typename</span> remove_const&lt;GridImp&gt;::type::Traits::template Codim&lt;0&gt;::Entity&amp; e, <span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l01151"></a>01151 <span class="keyword">  </span>{
<a name="l01152"></a>01152         <span class="keywordflow">return</span> grid.template getRealEntity&lt;0&gt;(e).<span class="keyword">template</span> subPersistentIndex&lt;cc&gt;(i);
<a name="l01153"></a>01153   }
<a name="l01154"></a>01154 
<a name="l01155"></a>01155 <span class="keyword">private</span>:
<a name="l01156"></a>01156   <span class="keyword">const</span> GridImp&amp; grid;
<a name="l01157"></a>01157 };
<a name="l01158"></a>01158 
<a name="l01159"></a>01159 
<a name="l01160"></a>01160 <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimworld&gt;
<a name="l01161"></a>01161 <span class="keyword">struct </span>SGridFamily
<a name="l01162"></a>01162 {
<a name="l01163"></a>01163   <span class="keyword">typedef</span> GridTraits&lt;dim,dimworld,Dune::SGrid&lt;dim,dimworld&gt;,
<a name="l01164"></a>01164                      SGeometry,SEntity,
<a name="l01165"></a>01165                      SEntityPointer,SLevelIterator,
<a name="l01166"></a>01166                      SIntersectionIterator, <span class="comment">// leaf  intersection iter </span>
<a name="l01167"></a>01167                      SIntersectionIterator, <span class="comment">// level intersection iter</span>
<a name="l01168"></a>01168                      SHierarchicIterator,
<a name="l01169"></a>01169                      SLevelIterator,
<a name="l01170"></a>01170                                          SGridLevelIndexSet&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01171"></a>01171                                          SGridLevelIndexSetTypes&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01172"></a>01172                                          SGridLeafIndexSet&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01173"></a>01173                                          SGridLeafIndexSetTypes&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01174"></a>01174                                          SGridGlobalIdSet&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01175"></a>01175                                          bigunsignedint&lt;dim*sgrid_dim_bits+sgrid_level_bits+sgrid_codim_bits&gt;,
<a name="l01176"></a>01176                                          SGridGlobalIdSet&lt;const SGrid&lt;dim,dimworld&gt; &gt;,
<a name="l01177"></a>01177                                          bigunsignedint&lt;dim*sgrid_dim_bits+sgrid_level_bits+sgrid_codim_bits&gt;, 
<a name="l01178"></a>01178                                          CollectiveCommunication&lt;Dune::SGrid&lt;dim,dimworld&gt; &gt; &gt; 
<a name="l01179"></a>01179   Traits;
<a name="l01180"></a>01180 };
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 
<a name="l01183"></a>01183 <span class="comment">//************************************************************************</span>
<a name="l01237"></a>01237 <span class="comment"></span><span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimworld&gt;
<a name="l01238"></a><a class="code" href="a00262.html">01238</a> <span class="keyword">class </span><a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a> : <span class="keyword">public</span> <a class="code" href="a00103.html">GridDefaultImplementation</a> &lt;dim,dimworld,sgrid_ctype,SGridFamily&lt;dim,dimworld&gt; &gt;
<a name="l01239"></a>01239 {
<a name="l01240"></a>01240 <span class="keyword">public</span>:
<a name="l01241"></a>01241   <span class="keyword">typedef</span> SGridFamily&lt;dim,dimworld&gt; GridFamily;
<a name="l01242"></a>01242   <span class="keyword">typedef</span> bigunsignedint&lt;dim*sgrid_dim_bits+sgrid_level_bits+sgrid_codim_bits&gt; PersistentIndexType;
<a name="l01243"></a>01243 
<a name="l01244"></a>01244   <span class="comment">// need for friend declarations in entity</span>
<a name="l01245"></a>01245   <span class="keyword">typedef</span> SGridLevelIndexSet&lt;SGrid&lt;dim,dimworld&gt; &gt; LevelIndexSetType;
<a name="l01246"></a>01246   <span class="keyword">typedef</span> SGridLeafIndexSet&lt;SGrid&lt;dim,dimworld&gt; &gt; LeafIndexSetType;
<a name="l01247"></a>01247   <span class="keyword">typedef</span> <a class="code" href="a00263.html" title="persistent, globally unique Ids">SGridGlobalIdSet&lt;SGrid&lt;dim,dimworld&gt;</a> &gt; <a class="code" href="a00263.html" title="persistent, globally unique Ids">GlobalIdSetType</a>;
<a name="l01248"></a>01248 
<a name="l01249"></a><a class="code" href="a00262.html#7414c2a8a4f06d4c46a12c425ddc7833">01249</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> SGridFamily&lt;dim,dimworld&gt;::Traits <a class="code" href="a00262.html#7414c2a8a4f06d4c46a12c425ddc7833" title="the traits of this class">Traits</a>;
<a name="l01250"></a>01250 
<a name="l01252"></a>01252   <span class="keyword">enum</span> { MAXL=32 };
<a name="l01253"></a>01253 
<a name="l01255"></a><a class="code" href="a00262.html#4c7cfa5e8d72cd584891deb39c8e1b87">01255</a>   <span class="keyword">typedef</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a> <a class="code" href="a00262.html#4c7cfa5e8d72cd584891deb39c8e1b87" title="define type used for coordinates in grid module">ctype</a>;
<a name="l01256"></a>01256 
<a name="l01258"></a><a class="code" href="a00262.html#1d1c6c5f6e638da1f0ff47a309902641">01258</a>   std::string <a class="code" href="a00262.html#1d1c6c5f6e638da1f0ff47a309902641" title="return the name of this grid">name</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">"SGrid"</span>; };
<a name="l01259"></a>01259 
<a name="l01260"></a>01260   <span class="comment">// constructors</span>
<a name="l01261"></a>01261 
<a name="l01269"></a>01269   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> (<span class="keyword">const</span> <span class="keywordtype">int</span>* N_, <span class="keyword">const</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>* H_);
<a name="l01270"></a>01270   
<a name="l01278"></a>01278   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> (<span class="keyword">const</span> <span class="keywordtype">int</span>* N_, <span class="keyword">const</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>* L_, <span class="keyword">const</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>* H_);
<a name="l01279"></a>01279 
<a name="l01289"></a>01289   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> (FieldVector&lt;int,dim&gt; N_, FieldVector&lt;sgrid_ctype,dim&gt; L_, FieldVector&lt;sgrid_ctype,dim&gt; H_);
<a name="l01290"></a>01290 
<a name="l01292"></a>01292   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> ();
<a name="l01293"></a>01293 
<a name="l01295"></a>01295   <a class="code" href="a00262.html#aa8a4ceb9e4efad33500deae4abc77c6" title="SGrid destructor.">~SGrid</a> ();
<a name="l01296"></a>01296 
<a name="l01299"></a>01299   <span class="keywordtype">int</span> <a class="code" href="a00262.html#e61127c663cd9f11095fd26ee223077b">maxLevel</a>() <span class="keyword">const</span>;
<a name="l01300"></a>01300 
<a name="l01302"></a>01302   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01303"></a>01303   <span class="keyword">typename</span> Traits::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::LevelIterator <a class="code" href="a00262.html#f8d5629bc7ded11d267c3955b2ae2db7" title="Iterator to first entity of given codim on level.">lbegin</a> (<span class="keywordtype">int</span> level) <span class="keyword">const</span>;
<a name="l01304"></a>01304 
<a name="l01306"></a>01306   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01307"></a>01307   <span class="keyword">typename</span> Traits::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::LevelIterator <a class="code" href="a00262.html#d1f789d30d8e1c77a44eb2efd83f0a42" title="one past the end on this level">lend</a> (<span class="keywordtype">int</span> level) <span class="keyword">const</span>;
<a name="l01308"></a>01308 
<a name="l01310"></a>01310   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01311"></a><a class="code" href="a00262.html#af9ba310ab8d57779f6a340d5496e5df">01311</a>   <span class="keyword">typename</span> Traits::template <a class="code" href="a00101.html" title="A Traits struct that collects all associated types of one implementation.">Codim&lt;cd&gt;::template</a> Partition&lt;All_Partition&gt;::LevelIterator <a class="code" href="a00262.html#f8d5629bc7ded11d267c3955b2ae2db7" title="Iterator to first entity of given codim on level.">lbegin</a> (<span class="keywordtype">int</span> level)<span class="keyword"> const</span>
<a name="l01312"></a>01312 <span class="keyword">    </span>{
<a name="l01313"></a>01313       <span class="keywordflow">return</span> lbegin&lt;cd,All_Partition&gt;(level);
<a name="l01314"></a>01314     }
<a name="l01315"></a>01315 
<a name="l01317"></a>01317   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01318"></a><a class="code" href="a00262.html#37ee4c31a72b454cae2e99538e91770b">01318</a>   <span class="keyword">typename</span> Traits::template <a class="code" href="a00101.html" title="A Traits struct that collects all associated types of one implementation.">Codim&lt;cd&gt;::template</a> Partition&lt;All_Partition&gt;::LevelIterator <a class="code" href="a00262.html#d1f789d30d8e1c77a44eb2efd83f0a42" title="one past the end on this level">lend</a> (<span class="keywordtype">int</span> level)<span class="keyword"> const</span>
<a name="l01319"></a>01319 <span class="keyword">    </span>{
<a name="l01320"></a>01320       <span class="keywordflow">return</span> lend&lt;cd,All_Partition&gt;(level);
<a name="l01321"></a>01321     }
<a name="l01322"></a>01322 
<a name="l01324"></a>01324   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01325"></a>01325   <span class="keyword">typename</span> Traits::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::LeafIterator <a class="code" href="a00262.html#0c9d6ee01dce74c89a6a9cac39c5566d" title="return LeafIterator which points to the first entity">leafbegin</a> () <span class="keyword">const</span>;
<a name="l01326"></a>01326 
<a name="l01328"></a>01328   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd, PartitionIteratorType pitype&gt;
<a name="l01329"></a>01329   <span class="keyword">typename</span> Traits::template Codim&lt;cd&gt;::template Partition&lt;pitype&gt;::LeafIterator <a class="code" href="a00262.html#bf0a7a4ecd1730ac5251de2d28e436ca" title="one past the end on the leaf level">leafend</a> () <span class="keyword">const</span>;
<a name="l01330"></a>01330 
<a name="l01332"></a>01332   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01333"></a><a class="code" href="a00262.html#90f8c640551443bd4d1d5c5c17649fca">01333</a>   <span class="keyword">typename</span> Traits::template <a class="code" href="a00101.html" title="A Traits struct that collects all associated types of one implementation.">Codim&lt;cd&gt;::template</a> Partition&lt;All_Partition&gt;::LeafIterator <a class="code" href="a00262.html#0c9d6ee01dce74c89a6a9cac39c5566d" title="return LeafIterator which points to the first entity">leafbegin</a> ()<span class="keyword"> const</span>
<a name="l01334"></a>01334 <span class="keyword">    </span>{
<a name="l01335"></a>01335       <span class="keywordflow">return</span> leafbegin&lt;cd,All_Partition&gt;();
<a name="l01336"></a>01336     }
<a name="l01337"></a>01337 
<a name="l01339"></a>01339   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> cd&gt;
<a name="l01340"></a><a class="code" href="a00262.html#310f82090374df6225973358f9f2c422">01340</a>   <span class="keyword">typename</span> Traits::template <a class="code" href="a00101.html" title="A Traits struct that collects all associated types of one implementation.">Codim&lt;cd&gt;::template</a> Partition&lt;All_Partition&gt;::LeafIterator <a class="code" href="a00262.html#bf0a7a4ecd1730ac5251de2d28e436ca" title="one past the end on the leaf level">leafend</a> ()<span class="keyword"> const</span>
<a name="l01341"></a>01341 <span class="keyword">    </span>{
<a name="l01342"></a>01342       <span class="keywordflow">return</span> leafend&lt;cd,All_Partition&gt;();
<a name="l01343"></a>01343     }
<a name="l01344"></a>01344 
<a name="l01356"></a>01356   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T, <span class="keyword">template</span>&lt;<span class="keyword">class</span>&gt; <span class="keyword">class </span>P, <span class="keywordtype">int</span> codim&gt;
<a name="l01357"></a><a class="code" href="a00262.html#5ee7c0d2139dc418017b6e08b5d30447">01357</a>   <span class="keywordtype">void</span> <a class="code" href="a00262.html#5ee7c0d2139dc418017b6e08b5d30447">communicate</a> (T&amp; t, <a class="code" href="a00492.html#ge799a4296824c1d4ae0d82e71287b722" title="Parameter to be used for the communication functions.">InterfaceType</a> iftype, <a class="code" href="a00492.html#gcf00ef51e7964e5797de12e1bdf8d755" title="Define a type for communication direction parameter.">CommunicationDirection</a> dir, <span class="keywordtype">int</span> level)
<a name="l01358"></a>01358   {
<a name="l01359"></a>01359           <span class="comment">// SGrid is sequential and has no periodic boundaries, so do nothing ...</span>
<a name="l01360"></a>01360           <span class="keywordflow">return</span>;
<a name="l01361"></a>01361   }
<a name="l01362"></a>01362 
<a name="l01364"></a>01364   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> codim) <span class="keyword">const</span>;
<a name="l01365"></a>01365 
<a name="l01367"></a><a class="code" href="a00262.html#c74a40fdf3fbf5bd189333c294dac4cb">01367</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a> (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01368"></a>01368 <span class="keyword">  </span>{
<a name="l01369"></a>01369         <span class="keywordflow">return</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a>(<a class="code" href="a00262.html#e61127c663cd9f11095fd26ee223077b">maxLevel</a>(),codim);
<a name="l01370"></a>01370   }
<a name="l01371"></a>01371 
<a name="l01373"></a><a class="code" href="a00262.html#ea5f12a1619fcbbfb42b2decc7476731">01373</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a> (<span class="keywordtype">int</span> level, GeometryType type)<span class="keyword"> const</span>
<a name="l01374"></a>01374 <span class="keyword">  </span>{
<a name="l01375"></a>01375       <span class="keywordflow">return</span> (type.isCube()) ? <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a>(level,dim-type.dim()) : 0;
<a name="l01376"></a>01376   }
<a name="l01377"></a>01377 
<a name="l01379"></a><a class="code" href="a00262.html#524247b4f2d2c1fdfc70df6734a52e5c">01379</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a> (GeometryType type)<span class="keyword"> const</span>
<a name="l01380"></a>01380 <span class="keyword">  </span>{
<a name="l01381"></a>01381         <span class="keywordflow">return</span> <a class="code" href="a00262.html#b471bbb3bd2d6c793def4e26ba6c8489" title="number of grid entities per level and codim">size</a>(<a class="code" href="a00262.html#e61127c663cd9f11095fd26ee223077b">maxLevel</a>(),type);
<a name="l01382"></a>01382   }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 
<a name="l01386"></a>01386   <span class="keywordtype">int</span> <a class="code" href="a00262.html#65781a6e55e6cefc1651fc1a3397de93" title="number of grid entities of all level for given codim">global_size</a> (<span class="keywordtype">int</span> codim) <span class="keyword">const</span>;
<a name="l01387"></a>01387 
<a name="l01389"></a><a class="code" href="a00262.html#4455c2eb696f6577601eebd46af90888">01389</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#4455c2eb696f6577601eebd46af90888" title="return size (= distance in graph) of overlap region">overlapSize</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> codim)
<a name="l01390"></a>01390   {
<a name="l01391"></a>01391         <span class="keywordflow">return</span> 0;
<a name="l01392"></a>01392   }
<a name="l01393"></a>01393 
<a name="l01395"></a><a class="code" href="a00262.html#2aab8f2fcf5e30944d7050805fd96887">01395</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#2aab8f2fcf5e30944d7050805fd96887" title="return size (= distance in graph) of ghost region">ghostSize</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> codim)
<a name="l01396"></a>01396   {
<a name="l01397"></a>01397         <span class="keywordflow">return</span> 0;
<a name="l01398"></a>01398   }
<a name="l01399"></a>01399 
<a name="l01400"></a>01400   <span class="comment">// these are all members specific to sgrid</span>
<a name="l01401"></a>01401 
<a name="l01403"></a>01403   <span class="keywordtype">void</span> <a class="code" href="a00262.html#a53fee70fbcbf6bbec0c7273e41a258a" title="Refine mesh globally by one refCount levels.">globalRefine</a> (<span class="keywordtype">int</span> refCount);
<a name="l01404"></a>01404 
<a name="l01406"></a><a class="code" href="a00262.html#ae765d9b921a478069cb701f6e60565a">01406</a>     <span class="keyword">const</span> array&lt;int, dim&gt;&amp; <a class="code" href="a00262.html#ae765d9b921a478069cb701f6e60565a" title="Get number of elements in each coordinate direction.">dims</a>(<span class="keywordtype">int</span> level)<span class="keyword"> const </span>{
<a name="l01407"></a>01407         <span class="keywordflow">return</span> N[level];
<a name="l01408"></a>01408     }
<a name="l01409"></a>01409 
<a name="l01411"></a><a class="code" href="a00262.html#f2e1f31e82f2c5b4913d69adaf186ca3">01411</a>     <span class="keyword">const</span> FieldVector&lt;sgrid_ctype, dimworld&gt;&amp; <a class="code" href="a00262.html#f2e1f31e82f2c5b4913d69adaf186ca3" title="Get lower left corner.">lowerLeft</a>()<span class="keyword"> const </span>{
<a name="l01412"></a>01412         <span class="keywordflow">return</span> low;
<a name="l01413"></a>01413     }
<a name="l01414"></a>01414 
<a name="l01416"></a><a class="code" href="a00262.html#971cf9bb7500b69648ad74ed3a142bee">01416</a>     FieldVector&lt;sgrid_ctype, dimworld&gt; <a class="code" href="a00262.html#971cf9bb7500b69648ad74ed3a142bee" title="Get upper right corner.">upperRight</a>()<span class="keyword"> const </span>{
<a name="l01417"></a>01417         <span class="keywordflow">return</span> H;
<a name="l01418"></a>01418     }
<a name="l01419"></a>01419 
<a name="l01421"></a><a class="code" href="a00262.html#27bd3499f4146ac296aad0e9b99d6a98">01421</a>   <span class="keywordtype">bool</span> <a class="code" href="a00262.html#27bd3499f4146ac296aad0e9b99d6a98" title="map adapt to global refine">adapt</a> ()    
<a name="l01422"></a>01422   {
<a name="l01423"></a>01423         <a class="code" href="a00262.html#a53fee70fbcbf6bbec0c7273e41a258a" title="Refine mesh globally by one refCount levels.">globalRefine</a>(1);
<a name="l01424"></a>01424         <span class="keywordflow">return</span> <span class="keyword">true</span>; 
<a name="l01425"></a>01425   }
<a name="l01426"></a>01426   
<a name="l01427"></a>01427 
<a name="l01429"></a>01429   FieldVector&lt;sgrid_ctype, dimworld&gt; <a class="code" href="a00262.html#956398d1231a50f46c6356d9d75d0a33" title="map expanded coordinates to position">pos</a> (<span class="keywordtype">int</span> level, array&lt;int,dim&gt;&amp; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a>) <span class="keyword">const</span>;
<a name="l01430"></a>01430  
<a name="l01432"></a>01432   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b50823eb64536ee11dff5edcab325df8" title="compute codim from coordinate">calc_codim</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a>) <span class="keyword">const</span>;
<a name="l01433"></a>01433 
<a name="l01435"></a>01435   <span class="keywordtype">int</span> <a class="code" href="a00262.html#998424fabafee0278e6d7cc06dcba387" title="compute number from expanded coordinate">n</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a>) <span class="keyword">const</span>;
<a name="l01436"></a>01436 
<a name="l01438"></a>01438   array&lt;int,dim&gt; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> codim) <span class="keyword">const</span>;
<a name="l01439"></a>01439         
<a name="l01441"></a>01441   array&lt;int,dim&gt; <a class="code" href="a00262.html#ce350b7457dd848bb929017ee137cc1c" title="compress from expanded coordinates to grid for a single partition number">compress</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a>) <span class="keyword">const</span>; 
<a name="l01442"></a>01442 
<a name="l01444"></a>01444   array&lt;int,dim&gt; <a class="code" href="a00262.html#0e1a99564f869a758db090ac6cabbb96" title="expand with respect to partition number">expand</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; r, <span class="keywordtype">int</span> b) <span class="keyword">const</span>; 
<a name="l01445"></a>01445 
<a name="l01449"></a>01449   <span class="keywordtype">int</span> <a class="code" href="a00262.html#b9aec678a379ed652a9c1a4938e076a6">partition</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; <a class="code" href="a00262.html#7290fe61ae226357724d02ba28f4c12a" title="compute coordinates from number and codimension">z</a>) <span class="keyword">const</span>; 
<a name="l01450"></a>01450 
<a name="l01452"></a>01452   <span class="keywordtype">bool</span> <a class="code" href="a00262.html#288bb6ea170b4f7a457c06ac77c43c92" title="given reduced coordinates of an element, determine if element is in the grid">exists</a> (<span class="keywordtype">int</span> level, <span class="keyword">const</span> array&lt;int,dim&gt;&amp; zred) <span class="keyword">const</span>;
<a name="l01453"></a>01453 
<a name="l01454"></a>01454 
<a name="l01455"></a>01455   <span class="comment">// The new index sets from DDM 11.07.2005</span>
<a name="l01456"></a><a class="code" href="a00262.html#b96a835d70c68d4fa5fe87bbbd0db830">01456</a>   <span class="keyword">const</span> <span class="keyword">typename</span> Traits::GlobalIdSet&amp; <a class="code" href="a00262.html#b96a835d70c68d4fa5fe87bbbd0db830" title="return const reference to the grids global id set">globalIdSet</a>()<span class="keyword"> const</span>
<a name="l01457"></a>01457 <span class="keyword">  </span>{
<a name="l01458"></a>01458         <span class="keywordflow">return</span> *theglobalidset;
<a name="l01459"></a>01459   }
<a name="l01460"></a>01460   
<a name="l01461"></a><a class="code" href="a00262.html#6ed399586276e647d0be6cfe8961ba85">01461</a>   <span class="keyword">const</span> <span class="keyword">typename</span> Traits::LocalIdSet&amp; <a class="code" href="a00262.html#6ed399586276e647d0be6cfe8961ba85" title="return const reference to the grids local id set">localIdSet</a>()<span class="keyword"> const</span>
<a name="l01462"></a>01462 <span class="keyword">  </span>{
<a name="l01463"></a>01463         <span class="keywordflow">return</span> *theglobalidset;
<a name="l01464"></a>01464   }
<a name="l01465"></a>01465 
<a name="l01466"></a><a class="code" href="a00262.html#0e16d410596933de4e7274254a38de5a">01466</a>   <span class="keyword">const</span> <span class="keyword">typename</span> Traits::LevelIndexSet&amp; <a class="code" href="a00262.html#0e16d410596933de4e7274254a38de5a" title="return const reference to the grids level index set for level level">levelIndexSet</a>(<span class="keywordtype">int</span> level)<span class="keyword"> const</span>
<a name="l01467"></a>01467 <span class="keyword">  </span>{
<a name="l01468"></a>01468         assert(level&gt;=0 &amp;&amp; level&lt;=<a class="code" href="a00262.html#e61127c663cd9f11095fd26ee223077b">maxLevel</a>());
<a name="l01469"></a>01469         <span class="keywordflow">return</span> *(indexsets[level]);
<a name="l01470"></a>01470   }
<a name="l01471"></a>01471 
<a name="l01472"></a><a class="code" href="a00262.html#9ab4c040c9ca5e9d84a1412162aace6d">01472</a>   <span class="keyword">const</span> <span class="keyword">typename</span> Traits::LeafIndexSet&amp; <a class="code" href="a00262.html#9ab4c040c9ca5e9d84a1412162aace6d" title="return const reference to the grids leaf index set">leafIndexSet</a>()<span class="keyword"> const</span>
<a name="l01473"></a>01473 <span class="keyword">  </span>{
<a name="l01474"></a>01474         <span class="keywordflow">return</span> *theleafindexset;
<a name="l01475"></a>01475   }
<a name="l01476"></a>01476 
<a name="l01477"></a>01477   <span class="comment">// dummy parallel functions</span>
<a name="l01478"></a>01478 
<a name="l01479"></a>01479   <span class="keyword">template</span>&lt;<span class="keyword">class</span> DataHandle&gt;
<a name="l01480"></a>01480   <span class="keywordtype">void</span> <a class="code" href="a00262.html#5ee7c0d2139dc418017b6e08b5d30447">communicate</a> (DataHandle&amp; data, <a class="code" href="a00492.html#ge799a4296824c1d4ae0d82e71287b722" title="Parameter to be used for the communication functions.">InterfaceType</a> iftype, <a class="code" href="a00492.html#gcf00ef51e7964e5797de12e1bdf8d755" title="Define a type for communication direction parameter.">CommunicationDirection</a> dir, <span class="keywordtype">int</span> level)<span class="keyword"> const</span>
<a name="l01481"></a>01481 <span class="keyword">  </span>{
<a name="l01482"></a>01482   }
<a name="l01483"></a>01483 
<a name="l01484"></a>01484   <span class="keyword">template</span>&lt;<span class="keyword">class</span> DataHandle&gt;
<a name="l01485"></a>01485   <span class="keywordtype">void</span> <a class="code" href="a00262.html#5ee7c0d2139dc418017b6e08b5d30447">communicate</a> (DataHandle&amp; data, <a class="code" href="a00492.html#ge799a4296824c1d4ae0d82e71287b722" title="Parameter to be used for the communication functions.">InterfaceType</a> iftype, <a class="code" href="a00492.html#gcf00ef51e7964e5797de12e1bdf8d755" title="Define a type for communication direction parameter.">CommunicationDirection</a> dir)<span class="keyword"> const</span>
<a name="l01486"></a>01486 <span class="keyword">  </span>{
<a name="l01487"></a>01487   }
<a name="l01488"></a>01488 
<a name="l01489"></a><a class="code" href="a00262.html#b0729b6115d37a5a3a5fcbf1e651df57">01489</a>   <span class="keyword">const</span> CollectiveCommunication&lt;SGrid&gt;&amp; <a class="code" href="a00262.html#b0729b6115d37a5a3a5fcbf1e651df57" title="return const reference to a collective communication object. The return type is a...">comm</a> ()<span class="keyword"> const</span>
<a name="l01490"></a>01490 <span class="keyword">  </span>{
<a name="l01491"></a>01491         <span class="keywordflow">return</span> ccobj;
<a name="l01492"></a>01492   }
<a name="l01493"></a>01493 
<a name="l01495"></a><a class="code" href="a00262.html#e54fbeda3ff1711464c3de41a5cd1bf2">01495</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#4455c2eb696f6577601eebd46af90888" title="return size (= distance in graph) of overlap region">overlapSize</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01496"></a>01496 <span class="keyword">  </span>{
<a name="l01497"></a>01497         <span class="keywordflow">return</span> 0;
<a name="l01498"></a>01498   }
<a name="l01499"></a>01499 
<a name="l01501"></a><a class="code" href="a00262.html#1a9bbe074dfd392531caf635969c6e8f">01501</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#4455c2eb696f6577601eebd46af90888" title="return size (= distance in graph) of overlap region">overlapSize</a> (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01502"></a>01502 <span class="keyword">  </span>{
<a name="l01503"></a>01503         <span class="keywordflow">return</span> 0;
<a name="l01504"></a>01504   }
<a name="l01505"></a>01505 
<a name="l01507"></a><a class="code" href="a00262.html#e05a1decd8fa872008f87d6ac6614826">01507</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#2aab8f2fcf5e30944d7050805fd96887" title="return size (= distance in graph) of ghost region">ghostSize</a> (<span class="keywordtype">int</span> level, <span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01508"></a>01508 <span class="keyword">  </span>{
<a name="l01509"></a>01509         <span class="keywordflow">return</span> 0;
<a name="l01510"></a>01510   }
<a name="l01511"></a>01511 
<a name="l01513"></a><a class="code" href="a00262.html#cbe71d640d152ff5cae7687117ede5ce">01513</a>   <span class="keywordtype">int</span> <a class="code" href="a00262.html#2aab8f2fcf5e30944d7050805fd96887" title="return size (= distance in graph) of ghost region">ghostSize</a> (<span class="keywordtype">int</span> codim)<span class="keyword"> const</span>
<a name="l01514"></a>01514 <span class="keyword">  </span>{
<a name="l01515"></a>01515         <span class="keywordflow">return</span> 0;
<a name="l01516"></a>01516   }
<a name="l01517"></a>01517 
<a name="l01518"></a>01518   <a class="code" href="a00273.html">SIntersectionIterator&lt;const SGrid&lt;dim, dimworld&gt;</a> &gt;&amp;
<a name="l01519"></a>01519   getRealIntersectionIterator(<span class="keyword">typename</span> Traits::LeafIntersectionIterator&amp; it) 
<a name="l01520"></a>01520   {
<a name="l01521"></a>01521     <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00103.html#373d2438b87aff06e9e50a384737df4f" title="return real implementation of interface class">getRealImplementation</a>(it);
<a name="l01522"></a>01522   }
<a name="l01523"></a>01523 
<a name="l01524"></a>01524   <span class="keyword">const</span> SIntersectionIterator&lt;const SGrid&lt;dim, dimworld&gt; &gt;&amp;
<a name="l01525"></a>01525   getRealIntersectionIterator(<span class="keyword">const</span> <span class="keyword">typename</span> Traits::LeafIntersectionIterator&amp; it)<span class="keyword"> const</span>
<a name="l01526"></a>01526 <span class="keyword">  </span>{
<a name="l01527"></a>01527     <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00103.html#373d2438b87aff06e9e50a384737df4f" title="return real implementation of interface class">getRealImplementation</a>(it);
<a name="l01528"></a>01528   }
<a name="l01529"></a>01529 
<a name="l01530"></a>01530 
<a name="l01531"></a>01531 <span class="keyword">private</span>:
<a name="l01532"></a>01532   <span class="comment">/*</span>
<a name="l01533"></a>01533 <span class="comment">    Make associated classes friends to grant access to the real entity</span>
<a name="l01534"></a>01534 <span class="comment">  */</span>
<a name="l01535"></a>01535   <span class="keyword">friend</span> <span class="keyword">class </span>Dune::SGridLevelIndexSet&lt;Dune::<a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a>&lt;dim,dimworld&gt; &gt;;
<a name="l01536"></a>01536   friend class Dune::SGridLeafIndexSet&lt;Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01537"></a>01537   friend class Dune::SGridGlobalIdSet&lt;Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01538"></a>01538   friend class Dune::SIntersectionIterator&lt;Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01539"></a>01539   friend class Dune::SHierarchicIterator&lt;Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01540"></a>01540   friend class Dune::SEntity&lt;0,dim,Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01541"></a>01541   
<a name="l01542"></a>01542   friend class Dune::SGridLevelIndexSet&lt;const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01543"></a>01543   friend class Dune::SGridLeafIndexSet&lt;const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01544"></a>01544   friend class Dune::SGridGlobalIdSet&lt;const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01545"></a>01545   friend class Dune::SIntersectionIterator&lt;const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01546"></a>01546   friend class Dune::SHierarchicIterator&lt;const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01547"></a>01547   friend class Dune::SEntity&lt;0,dim,const Dune::SGrid&lt;dim,dimworld&gt; &gt;;
<a name="l01548"></a>01548   
<a name="l01549"></a>01549   template&lt;int codim_, int dim_, class GridImp_, template&lt;int,int,class&gt; class EntityImp_&gt;
<a name="l01550"></a>01550   friend class Entity;
<a name="l01551"></a>01551 
<a name="l01552"></a>01552   <span class="comment">/*</span>
<a name="l01553"></a>01553 <span class="comment">    private methods</span>
<a name="l01554"></a>01554 <span class="comment">   */</span>
<a name="l01555"></a>01555   template&lt;int codim&gt;
<a name="l01556"></a>01556   SEntity&lt;codim,dim,const SGrid&lt;dim,dimworld&gt; &gt;&amp; getRealEntity(typename Traits::template Codim&lt;codim&gt;::Entity&amp; e )
<a name="l01557"></a>01557   {
<a name="l01558"></a>01558     <span class="keywordflow">return</span> this-&gt;getRealImplementaion(e);
<a name="l01559"></a>01559   }
<a name="l01560"></a>01560   
<a name="l01561"></a>01561   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> codim&gt;
<a name="l01562"></a>01562   <span class="keyword">const</span> SEntity&lt;codim,dim,const SGrid&lt;dim,dimworld&gt; &gt;&amp; getRealEntity(<span class="keyword">const</span> <span class="keyword">typename</span> Traits::template Codim&lt;codim&gt;::Entity&amp; e )<span class="keyword"> const</span>
<a name="l01563"></a>01563 <span class="keyword">  </span>{
<a name="l01564"></a>01564     <span class="keywordflow">return</span> this-&gt;<a class="code" href="a00103.html#373d2438b87aff06e9e50a384737df4f" title="return real implementation of interface class">getRealImplementation</a>(e);
<a name="l01565"></a>01565   }
<a name="l01566"></a>01566   
<a name="l01567"></a>01567   <span class="comment">// diasable copy and assign</span>
<a name="l01568"></a>01568   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a>(<span class="keyword">const</span> <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> &amp;) {};
<a name="l01569"></a>01569   <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> &amp; operator = (<span class="keyword">const</span> <a class="code" href="a00262.html#d02a4882a9e3949b68c800ac32f2ffc0" title="empty constructor making grid of unit square discretized with one cell">SGrid</a> &amp;) { <span class="keywordflow">return</span> *<span class="keyword">this</span>; };
<a name="l01570"></a>01570   <span class="comment">// generate SGrid </span>
<a name="l01571"></a>01571   <span class="keywordtype">void</span> makeSGrid (<span class="keyword">const</span> <span class="keywordtype">int</span>* N_,  <span class="keyword">const</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>* L_, <span class="keyword">const</span> <a class="code" href="a00441.html#a2a12e0d35af55595a81465ce46c87cb">sgrid_ctype</a>* H_);
<a name="l01572"></a>01572 
<a name="l01573"></a>01573   <span class="comment">/*</span>
<a name="l01574"></a>01574 <span class="comment">    internal data</span>
<a name="l01575"></a>01575 <span class="comment">   */</span>
<a name="l01576"></a>01576   CollectiveCommunication&lt;SGrid&gt; ccobj;
<a name="l01577"></a>01577 
<a name="l01578"></a>01578   std::vector&lt;SGridLevelIndexSet&lt;const SGrid&lt;dim,dimworld&gt; &gt;*&gt; indexsets;
<a name="l01579"></a>01579   SGridLeafIndexSet&lt;const SGrid&lt;dim,dimworld&gt; &gt; *theleafindexset;
<a name="l01580"></a>01580   SGridGlobalIdSet&lt;const SGrid&lt;dim,dimworld&gt; &gt; *theglobalidset;
<a name="l01581"></a>01581 
<a name="l01582"></a>01582   <span class="keywordtype">int</span> L;                          <span class="comment">// number of levels in hierarchic mesh 0&lt;=level&lt;L</span>
<a name="l01583"></a>01583   FieldVector&lt;sgrid_ctype, dim&gt; low;     <span class="comment">// lower left corner of the grid</span>
<a name="l01584"></a>01584   FieldVector&lt;sgrid_ctype, dim&gt; H;       <span class="comment">// length of cube per direction</span>
<a name="l01585"></a>01585   array&lt;int,dim&gt; *N;                <span class="comment">// number of elements per direction</span>
<a name="l01586"></a>01586   FieldVector&lt;sgrid_ctype, dim&gt; *h;      <span class="comment">// mesh size per direction</span>
<a name="l01587"></a>01587   <span class="keyword">mutable</span> CubeMapper&lt;dim&gt; *mapper;       <span class="comment">// a mapper for each level</span>
<a name="l01588"></a>01588   
<a name="l01589"></a>01589   <span class="comment">// faster implemantation od subIndex </span>
<a name="l01590"></a>01590   <span class="keyword">mutable</span> array &lt;int,dim&gt; zrefStatic;     <span class="comment">// for subIndex of SEntity</span>
<a name="l01591"></a>01591   <span class="keyword">mutable</span> array &lt;int,dim&gt; zentityStatic;  <span class="comment">// for subIndex of SEntity</span>
<a name="l01592"></a>01592 };
<a name="l01593"></a>01593 
<a name="l01594"></a>01594 <span class="keyword">namespace </span>Capabilities
<a name="l01595"></a>01595 {
<a name="l01596"></a>01596 
<a name="l01608"></a>01608   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimw, <span class="keywordtype">int</span> cdim&gt;
<a name="l01609"></a><a class="code" href="a00121.html">01609</a>   <span class="keyword">struct </span><a class="code" href="a00115.html" title="Specialize with &amp;#39;true&amp;#39; for all codims that a grid implements entities for...">hasEntity</a>&lt; <a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>&lt;dim,dimw&gt;, cdim&gt;
<a name="l01610"></a>01610   {
<a name="l01611"></a>01611     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> v = <span class="keyword">true</span>;
<a name="l01612"></a>01612   };
<a name="l01613"></a>01613   
<a name="l01617"></a>01617   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimw&gt;
<a name="l01618"></a><a class="code" href="a00170.html">01618</a>   <span class="keyword">struct </span><a class="code" href="a00164.html" title="Specialize with &amp;#39;true&amp;#39; if implementation guarantees conforming level grids...">isLevelwiseConforming</a>&lt; <a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>&lt;dim,dimw&gt; &gt;
<a name="l01619"></a>01619   {
<a name="l01620"></a>01620     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> v = <span class="keyword">true</span>;
<a name="l01621"></a>01621   };
<a name="l01622"></a>01622 
<a name="l01626"></a>01626   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimw&gt;
<a name="l01627"></a><a class="code" href="a00161.html">01627</a>   <span class="keyword">struct </span><a class="code" href="a00158.html" title="Specialize with &amp;#39;true&amp;#39; if implementation guarantees a conforming leaf grid...">isLeafwiseConforming</a>&lt; <a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>&lt;dim,dimw&gt; &gt;
<a name="l01628"></a>01628   {
<a name="l01629"></a>01629     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> v = <span class="keyword">true</span>;
<a name="l01630"></a>01630   };
<a name="l01631"></a>01631 
<a name="l01635"></a>01635   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimw&gt;
<a name="l01636"></a><a class="code" href="a00181.html">01636</a>   <span class="keyword">struct </span><a class="code" href="a00180.html" title="Specialize with &amp;#39;true&amp;#39; if implementation provides unstructured grids. (default=true)...">IsUnstructured</a>&lt; <a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>&lt;dim,dimw&gt; &gt;
<a name="l01637"></a>01637   {
<a name="l01638"></a>01638     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> v = <span class="keyword">false</span>;
<a name="l01639"></a>01639   };
<a name="l01640"></a>01640 
<a name="l01644"></a>01644   <span class="keyword">template</span>&lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> dimw&gt;
<a name="l01645"></a><a class="code" href="a00132.html">01645</a>   <span class="keyword">struct </span><a class="code" href="a00126.html" title="Specialize with &amp;#39;true&amp;#39; if implementation provides grids with hanging nodes...">hasHangingNodes</a>&lt; <a class="code" href="a00262.html" title="[ provides Dune::Grid ]">SGrid</a>&lt;dim,dimw&gt; &gt;
<a name="l01646"></a>01646   {
<a name="l01647"></a>01647     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> v = <span class="keyword">false</span>;
<a name="l01648"></a>01648   };
<a name="l01649"></a>01649   
<a name="l01650"></a>01650 } <span class="comment">// end namespace Capabilities</span>
<a name="l01651"></a>01651 
<a name="l01652"></a>01652 } <span class="comment">// end namespace Dune</span>
<a name="l01653"></a>01653 
<a name="l01654"></a>01654 <span class="preprocessor">#include"sgrid/sgrid.cc"</span>
<a name="l01655"></a>01655 
<a name="l01656"></a>01656 <span class="preprocessor">#endif</span>
</pre></div></div>
</div> <!-- end doxygen -->
</div> <!-- end main -->
<div class="foot">

<p class="foot">
  Generated on 6 Nov 2008 with <a
  href="http://www.doxygen.org/">Doxygen</a> (ver 1.5.6)  
  [<a href="doxygen.log">logfile</a>].
</p>

</div>

</body>
</html>
